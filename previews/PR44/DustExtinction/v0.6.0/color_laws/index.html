<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/previews/PR43/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Color Laws ¬∑ DustExtinction.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="https://JuliaAstro.org/previews/PR43/DustExtinction/stable/color_laws/" rel="canonical"/><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="../../.."><img alt="home" src="../../../assets/logo.svg"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../docs/">Home</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Data I/O</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../AstroImages/">AstroImages</a><a class="nav-link nav-item" href="../../../CFITSIO/">CFITSIO</a><a class="nav-link nav-item" href="../../../FITSIO/">FITSIO</a><a class="nav-link nav-item" href="https://eschnett.github.io/ASDF2.jl/dev/" target="_blank">eschnett/ASDF2</a><a class="nav-link nav-item" href="http://mweastwood.info/CasaCore.jl/stable/" target="_blank">mweastwood/CasaCore</a><a class="nav-link nav-item" href="https://aplavin.github.io/Difmap.jl/test/examples.html" target="_blank">JuliaAPlavin/Difmap</a><a class="nav-link nav-item" href="https://github.com/emmt/OIFITS.jl?tab=readme-ov-file#support-for-oi-fits-data-in-julia" target="_blank">emmt/OIFITS</a><a class="nav-link nav-item" href="https://github.com/JuliaAPlavin/VirtualObservatory.jl?tab=readme-ov-file#virtualobservatoryjl" target="_blank">JuliaAPlavin/VirtualObservatory</a><a class="nav-link nav-item" href="https://aplavin.github.io/VLBIData.jl/test/examples.html" target="_blank">JuliaAPlavin/VLBIData</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Images</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../AstroImages/">AstroImages</a><a class="nav-link nav-item" href="../../../CCDReduction/">CCDReduction</a><a class="nav-link nav-item" href="../../../LACosmic/">LACosmic</a><a class="nav-link nav-item" href="../../../Photometry/">Photometry</a><a class="nav-link nav-item" href="../../../PSFModels/">PSFModels</a><a class="nav-link nav-item" href="https://github.com/JuliaAstro/Reproject.jl?tab=readme-ov-file#reproject" target="_blank">Reproject</a><a class="nav-link nav-item" href="../../../SAOImageDS9/">SAOImageDS9</a><a class="nav-link nav-item" href="http://JuliaHCI.github.io/ADI.jl/stable/" target="_blank">JuliaHCI/ADI</a><a class="nav-link nav-item" href="http://JuliaHCI.github.io/HCIToolbox.jl/stable/" target="_blank">JuliaHCI/HCIToolbox</a><a class="nav-link nav-item" href="http://JuliaHCI.github.io/SubpixelRegistration.jl/stable/" target="_blank">JuliaHCI/SubpixelRegistration</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Time, Coords, Units</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../AstroAngles/">AstroAngles</a><a class="nav-link nav-item" href="../../../AstroTime/">AstroTime</a><a class="nav-link nav-item" href="https://github.com/JuliaAstro/ERFA.jl?tab=readme-ov-file#erfajl" target="_blank">ERFA</a><a class="nav-link nav-item" href="../../../SkyCoords/">SkyCoords</a><a class="nav-link nav-item" href="../../../SPICE/">SPICE</a><a class="nav-link nav-item" href="../../../UnitfulAstro/">UnitfulAstro</a><a class="nav-link nav-item" href="../../../WCS/">WCS</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Orbits</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../EarthOrientation/">EarthOrientation</a><a class="nav-link nav-item" href="../../../Transits/">Transits</a><a class="nav-link nav-item" href="https://juliaastro.org/EphemerisSources.jl/docs" target="_blank">EphemerisSources</a><a class="nav-link nav-item" href="https://barrettp.github.io/Astrometry/dev" target="_blank">barrettp/Astrometry</a><a class="nav-link nav-item" href="https://github.com/PerezHz/HORIZONS.jl?tab=readme-ov-file#horizonsjl" target="_blank">PerezHz/HORIZONS</a><a class="nav-link nav-item" href="https://github.com/helgee/JPLEphemeris.jl?tab=readme-ov-file#jplephemerisjl" target="_blank">helgee/JPLEphemeris</a><a class="nav-link nav-item" href="https://sefffal.github.io/PlanetOrbits.jl/stable/" target="_blank">sefffal/PlanetOrbits</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">General</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../AstroLib/">AstroLib</a><a class="nav-link nav-item" href="../../../BoxLeastSquares/">BoxLeastSquares</a><a class="nav-link nav-item" href="../../../Cosmology/">Cosmology</a><a class="nav-link active nav-item" href="../../">DustExtinction</a><a class="nav-link nav-item" href="../../../LombScargle/">LombScargle</a><a class="nav-link nav-item" href="../../../Photometry/">Photometry</a><a class="nav-link nav-item" href="http://mileslucas.com/BiweightStats.jl/stable/" target="_blank">mileslucas/BiweightStats</a><a class="nav-link nav-item" href="https://ziotom78.github.io/Healpix.jl/stable/" target="_blank">ziotom78/Healpix</a><a class="nav-link nav-item" href="https://ajwheeler.github.io/Korg.jl/stable/" target="_blank">ajwheeler/Korg</a><a class="nav-link nav-item" href="https://manuelbehrendt.github.io/Mera.jl/stable/" target="_blank">ManuelBehrendt/Mera</a><a class="nav-link nav-item" href="https://juliaspace.github.io/SatelliteToolbox.jl/stable/" target="_blank">JuliaSpace/SatelliteToolbox</a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><nav class="toc"><a href="../"><img alt="DustExtinction.jl logo" class="logo" src="../assets/logo.svg"/></a><h1>DustExtinction.jl</h1><select id="version-selector" onchange="window.location.href=this.value" style="visibility: hidden"></select><form action="../search/" class="search" id="search-form"><input id="search-query" name="q" placeholder="Search docs" type="text"/></form><ul><li><a class="toctext" href="../">Home</a></li><li class="current"><a class="toctext" href="">Color Laws</a><ul class="internal"><li><a class="toctext" href="#Usage-1">Usage</a></li><li><a class="toctext" href="#Advanced-Usage-1">Advanced Usage</a></li><li><a class="toctext" href="#API/Reference-1">API/Reference</a></li></ul></li><li><a class="toctext" href="../dust_maps/">Dust Maps</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="">Color Laws</a></li></ul><a class="edit-page" href="https://github.com/JuliaAstro/DustExtinction.jl/blob/master/docs/src/color_laws.md"><span class="fa">ÔÇõ</span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Color Laws</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" href="#laws-1" id="laws-1">Color laws</a></h1><p>The following empirical laws allow us to model the reddening of light as it travels to us. The law you use should depend on the type of data you have and the goal of its use. <a href="#DustExtinction.ccm89"><code>ccm89</code></a> is very common for use in removing extinction from stellar observations, but <a href="#DustExtinction.cal00"><code>cal00</code></a>, for instance, is suited for galaxies with massive stars. Look through the citations and documentation for each law to get a better idea of what sort of physics it targets. </p><h2><a class="nav-anchor" href="#Usage-1" id="Usage-1">Usage</a></h2><pre><code class="language-julia-repl">julia&gt; ccm89(4000., 3.1)
1.464555702942584
</code></pre><p>These laws can be applied across higher dimension arrays using the <code>.</code> operator</p><pre><code class="language-julia-repl">julia&gt; ccm89.([4000., 5000.], 3.1)
2-element Array{Float64,1}:
 1.464555702942584
 1.1222468788993019
</code></pre><p>these laws return magnitudes, which we can apply directly to flux by mulitplication with a base-2.5 logarithmic system (because astronomers are fun):</p><div>\[f = f \cdot 10 ^ {-0.4A_v\cdot mag}\]</div><p>To make this easier, we provide a convenient <a href="#DustExtinction.redden"><code>redden</code></a> function for applying these color laws to flux measurements.</p><pre><code class="language-julia-repl">julia&gt; wave = range(4000, 5000, length=4)
4000.0:333.3333333333333:5000.0

julia&gt; flux = 1e-8 .* wave .+ 1e-2
0.01004:3.3333333333333333e-6:0.01005

julia&gt; redden.(flux, wave, 0.3)
4-element Array{Float64,1}:
 0.006698646015454752
 0.006918253926353551
 0.007154659823737299
 0.007370491272731541
</code></pre><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>If you are concerned with memory and would like an in-place broadcasted version of <a href="#DustExtinction.redden"><code>redden</code></a> use it with <a href="https://docs.julialang.org/en/v1/base/collections/#Base.map!"><code>Base.map!</code></a></p><pre><code class="language-julia">map!((f,w)-&gt;redden(f, w, 0.3), flux, flux, wave)</code></pre></div></div><h2><a class="nav-anchor" href="#Advanced-Usage-1" id="Advanced-Usage-1">Advanced Usage</a></h2><p>The color laws also have built-in support for uncertainties using <a href="https://github.com/juliaphysics/measurements.jl">Measurements.jl</a>.</p><pre><code class="language-julia-repl">julia&gt; using Measurements

julia&gt; ccm89.([4000. ¬± 10.5, 5000. ¬± 10.2], 3.1)
2-element Array{Measurement{Float64},1}:
 1.4646 ¬± 0.0033
 1.1222 ¬± 0.003
</code></pre><p>and also support units via <a href="https://github.com/painterqubits/unitful.jl">Unitful.jl</a> and its subsidiaries. Notice how the output type is now <code>Unitful.Gain</code>.</p><pre><code class="language-julia-repl">julia&gt; using Unitful, UnitfulAstro

julia&gt; mags = ccm89.([4000u"angstrom", 0.5u"Œºm"], 3.1)
2-element Array{Gain{Unitful.LogInfo{:Magnitude,10,-2.5},:?,Float64},1}:
 1.4645557029425837 mag
 1.1222468788993019 mag
</code></pre><p>You can even combine the two above to get some really nice workflows exploiting all Julia has to offer! This example shows how you could redden some OIR observational data with uncertainties in the flux density.</p><pre><code class="language-julia-repl">julia&gt; using Measurements, Unitful, UnitfulAstro

julia&gt; wave = range(0.3, 1.0, length=5)u"Œºm"
(0.3:0.175:1.0) Œºm

julia&gt; err = randn(length(wave))
5-element Array{Float64,1}:
  0.2972879845354616
  0.3823959677906078
 -0.5976344767282311
 -0.01044524463737564
 -0.839026854388764

julia&gt; flux = @.(300 / ustrip(wave)^4 ¬± err)*u"Jy"
5-element Array{Quantity{Measurement{Float64},ùêå*ùêì^-2,Unitful.FreeUnits{(Jy,),ùêå*ùêì^-2,nothing}},1}:
  37037.04 ¬± 0.3 Jy
  5893.14 ¬± 0.38 Jy
  1680.61 ¬± -0.6 Jy
 647.598 ¬± -0.01 Jy
   300.0 ¬± -0.84 Jy

julia&gt; redden.(flux, wave, 0.3)
5-element Array{Quantity{Measurement{Float64},ùêå*ùêì^-2,Unitful.FreeUnits{(Jy,),ùêå*ùêì^-2,nothing}},1}:
    22410.8 ¬± 0.18 Jy
    4229.74 ¬± 0.27 Jy
    1337.12 ¬± 0.48 Jy
 554.3349 ¬± 0.0089 Jy
     268.31 ¬± 0.75 Jy
</code></pre><h2><a class="nav-anchor" href="#API/Reference-1" id="API/Reference-1">API/Reference</a></h2><h3><a class="nav-anchor" href="#Helper-Functions-1" id="Helper-Functions-1">Helper Functions</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" href="#DustExtinction.redden" id="DustExtinction.redden"><code>DustExtinction.redden</code></a> ‚Äî <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">redden(f::Real, Œª::Real, Av; Rv=3.1, law=ccm89)
redden(f::Quantity, Œª::Quantity, Av; Rv=3.1, law=ccm89)</code></pre><p>Redden the value <code>f</code> by the value calculated via the given law and total  extinction value <code>Av</code>. By default we use <code>Rv=3.1</code> which is the Milky Way  average selective attenuation. Note that Œª should be in Angstrom if it is not  a <code>Quantity</code>.</p></div></div><a class="source-link" href="https://github.com/JuliaAstro/DustExtinction.jl/blob/a39125be77a98b8c397724199e3b389cb82e331f/src/DustExtinction.jl#L23-L31" target="_blank">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" href="#DustExtinction.deredden" id="DustExtinction.deredden"><code>DustExtinction.deredden</code></a> ‚Äî <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">deredden(f::Real, Œª::Real, Av; Rv=3.1, law=ccm89)
deredden(f::Quantity, Œª::Quantity, Av; Rv=3.1, law=ccm89)</code></pre><p>Deredden the value <code>f</code> by the value calculated via the given law and total  extinction value <code>Av</code>. By default we use <code>Rv=3.1</code> which is the Milky Way  average selective attenuation. Note that Œª should be in Angstrom if it is not  a <code>Quantity</code>.</p></div></div><a class="source-link" href="https://github.com/JuliaAstro/DustExtinction.jl/blob/a39125be77a98b8c397724199e3b389cb82e331f/src/DustExtinction.jl#L35-L43" target="_blank">source</a></section><h3><a class="nav-anchor" href="#Parametric-Extinction-Laws-1" id="Parametric-Extinction-Laws-1">Parametric Extinction Laws</a></h3><p>These laws are all parametrized by the selective extinction <code>Rv</code>. Mathematically, this is the ratio of the total extinction by the reddening</p><div>\[R_V = \frac{A_V}{E(B-V)}\]</div><p>and is loosely associated with the size of the dust grains in the interstellar medium.</p><h4><a class="nav-anchor" href="#Clayton,-Cardelli-and-Mathis-(1989)-1" id="Clayton,-Cardelli-and-Mathis-(1989)-1">Clayton, Cardelli and Mathis (1989)</a></h4><p><img alt="" src="../assets/ccm89_plot.svg"/></p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" href="#DustExtinction.ccm89" id="DustExtinction.ccm89"><code>DustExtinction.ccm89</code></a> ‚Äî <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">ccm89(Œª::Real, Rv=3.1)
ccm89(Œª::Quantity, Rv=3.1)</code></pre><p>Clayton, Cardelli and Mathis (1989) dust law. </p><p>Returns E(B-V) in magnitudes at the given wavelength relative to the extinction  at 5494.5 √Ö. <code>Œª</code> is the wavelength in √Ö and has support over [1000, 33333].  Outside of that range this will return 0. <code>Rv</code> is the selective extinction  and is valid over [2, 6]. A typical value for the Milky Way is 3.1</p><p>If <code>Œª</code> is a <code>Unitful.Quantity</code> it will be automatically converted to √Ö and the  returned value will be <code>UnitfulAstro.mag</code>.</p><p><strong>References</strong></p><p><a href="https://ui.adsabs.harvard.edu/abs/1989ApJ...345..245C">Clayton,Cardelli and Mathis (1989)</a></p></div></div><a class="source-link" href="https://github.com/JuliaAstro/DustExtinction.jl/blob/a39125be77a98b8c397724199e3b389cb82e331f/src/color_laws.jl#L16-L32" target="_blank">source</a></section><h4><a class="nav-anchor" href="#O&#39;Donnell-1994-1" id="O&#39;Donnell-1994-1">O'Donnell 1994</a></h4><p><img alt="" src="../assets/od94_plot.svg"/></p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" href="#DustExtinction.od94" id="DustExtinction.od94"><code>DustExtinction.od94</code></a> ‚Äî <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">od94(Œª::Real, Rv=3.1)
od94(Œª::Quantity, Rv=3.1)</code></pre><p>O'Donnell (1994) dust law.</p><p>This is identical to the Clayton, Cardelli and Mathis (1989) dust law, except  for different coefficients used in the optical (3030.3 √Ö to 9090.9 √Ö).</p><p>If <code>Œª</code> is a <code>Unitful.Quantity</code> it will be automatically converted to √Ö and  the returned value will be <code>UnitfulAstro.mag</code>.</p><p><strong>References</strong></p><p><a href="https://ui.adsabs.harvard.edu/abs/1994ApJ...422..158O">O'Donnell (1994)</a></p><p><strong>See Also</strong></p><p><a href="#DustExtinction.ccm89"><code>ccm89</code></a></p></div></div><a class="source-link" href="https://github.com/JuliaAstro/DustExtinction.jl/blob/a39125be77a98b8c397724199e3b389cb82e331f/src/color_laws.jl#L40-L57" target="_blank">source</a></section><h4><a class="nav-anchor" href="#Calzetti-et-al.-(2000)-1" id="Calzetti-et-al.-(2000)-1">Calzetti et al. (2000)</a></h4><p><img alt="" src="../assets/cal00_plot.svg"/></p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" href="#DustExtinction.cal00" id="DustExtinction.cal00"><code>DustExtinction.cal00</code></a> ‚Äî <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">cal00(Œª::Real, Rv=4.05)
cal00(Œª::Quantity, Rv=4.05)</code></pre><p>Calzetti et al. (2000) Dust Law.</p><p>Returns E(B-V) in magnitudes at the given wavelength. <code>Œª</code> is the wavelength in √Ö  and has support over [1200, 22000]. Outside of that range this will return 0. </p><p>Calzetti et al. (2000) developed a recipe for dereddening the spectra of  galaxies where massive stars dominate the radiation output. They found the best  fit value for such galaxies was 4.05¬±0.80.</p><p>If <code>Œª</code> is a <code>Unitful.Quantity</code> it will be automatically converted to √Ö and the  returned value will be <code>UnitfulAstro.mag</code>.</p><p><strong>References</strong></p><p><a href="https://ui.adsabs.harvard.edu/abs/2000ApJ...533..682C">Calzetti et al. (2000)</a></p></div></div><a class="source-link" href="https://github.com/JuliaAstro/DustExtinction.jl/blob/a39125be77a98b8c397724199e3b389cb82e331f/src/color_laws.jl#L98-L116" target="_blank">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="../dust_maps/"><span class="direction">Next</span><span class="title">Dust Maps</span></a></footer></article></body></HTML>