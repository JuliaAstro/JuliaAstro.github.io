<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/'</script><script charset="utf-8" src="../../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Using datasets · SpectralFitting.jl</title><meta content="Using datasets · SpectralFitting.jl" name="title"/><meta content="Using datasets · SpectralFitting.jl" property="og:title"/><meta content="Using datasets · SpectralFitting.jl" property="twitter:title"/><meta content="Documentation for SpectralFitting.jl." name="description"/><meta content="Documentation for SpectralFitting.jl." property="og:description"/><meta content="Documentation for SpectralFitting.jl." property="twitter:description"/><script data-outdated-warner="" src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" data-theme-name="catppuccin-mocha" href="../../assets/themes/catppuccin-mocha.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-macchiato" href="../../assets/themes/catppuccin-macchiato.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-frappe" href="../../assets/themes/catppuccin-frappe.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-latte" href="../../assets/themes/catppuccin-latte.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../../assets/themeswap.js"></script><link href="https://JuliaAstro.org/SpectralFitting/stable/datasets/datasets/" rel="canonical"/><link href="../../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="../../../.."><img alt="home" src="../../../../assets/logo.svg"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../../home/">Home</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Domain</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Solar System</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../CALCEPH/">⬤ CALCEPH</a><a class="nav-link nav-item" href="https://juliaastro.org/EphemerisSources.jl" target="_blank">⬤ EphemerisSources</a><a class="nav-link nav-item" href="https://juliaastro.org/GeneralAstrodynamics.jl" target="_blank">⬤ GeneralAstrodynamics</a><a class="nav-link nav-item" href="https://github.com/PerezHz/HORIZONS.jl?tab=readme-ov-file#horizonsjl" target="_blank">⬤ HORIZONS</a><a class="nav-link nav-item" href="https://juliaspace.github.io/SatelliteToolbox.jl/stable/" target="_blank">⬤ SatelliteToolbox</a><a class="nav-link nav-item" href="../../../../SolarPosition/">⬤ SolarPosition</a><a class="nav-link nav-item" href="../../../../SPICE/">⬤ SPICE</a></ul></div><div class="nav-mega-column"><div class="column-header">Exoplanets</div><ul class="column-content"><a class="nav-link nav-item" href="http://JuliaHCI.github.io/ADI.jl/stable/" target="_blank">⬤ ADI</a><a class="nav-link nav-item" href="http://JuliaHCI.github.io/HCIToolbox.jl/stable/" target="_blank">⬤ HCIToolbox</a><a class="nav-link nav-item" href="../../../../Orbits/">⬤ Orbits</a><a class="nav-link nav-item" href="https://sefffal.github.io/PlanetOrbits.jl/dev/" target="_blank">⬤ PlanetOrbits</a><a class="nav-link nav-item" href="../../../../Transits/">⬤ Transits</a></ul></div><div class="nav-mega-column"><div class="column-header">Stars</div><ul class="column-content"><a class="nav-link nav-item" href="https://cgarling.github.io/BolometricCorrections.jl/stable/" target="_blank">⬤ BolometricCorrections</a><a class="nav-link nav-item" href="https://cgarling.github.io/InitialMassFunctions.jl/stable/" target="_blank">⬤ InitialMassFunctions</a><a class="nav-link nav-item" href="https://cgarling.github.io/StarFormationHistories.jl/stable/" target="_blank">⬤ StarFormationHistories</a></ul></div><div class="nav-mega-column"><div class="column-header">Galaxies and Cosmology</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../Cosmology/">⬤ Cosmology</a><a class="nav-link nav-item" href="../../../../DustExtinction/">⬤ DustExtinction</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/ScatteringOptics.jl/stable/" target="_blank">⬤ ScatteringOptics</a></ul></div></div></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Techniques</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Photometry</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../CCDReduction/">⬤ CCDReduction</a><a class="nav-link nav-item" href="../../../../LACosmic/">⬤ LACosmic</a><a class="nav-link nav-item" href="../../../../Photometry/">⬤ Photometry</a><a class="nav-link nav-item" href="../../../../PhotometricFilters/">⬤ PhotometricFilters</a><a class="nav-link nav-item" href="../../../../PSFModels/">⬤ PSFModels</a><a class="nav-link nav-item" href="../../../../SAOImageDS9/">⬤ SAOImageDS9</a></ul></div><div class="nav-mega-column"><div class="column-header">Astrometry</div><ul class="column-content"><a class="nav-link nav-item" href="https://barrettp.github.io/Astrometry/dev" target="_blank">⬤ Astrometry</a><a class="nav-link nav-item" href="../../../../AstroTime/">⬤ AstroTime</a><a class="nav-link nav-item" href="../../../../EarthOrientation/">⬤ EarthOrientation</a><a class="nav-link nav-item" href="../../../../ERFA/">◯ ERFA</a><a class="nav-link nav-item" href="../../../../Healpix/">⬤ Healpix</a><a class="nav-link nav-item" href="../../../../Reproject/">⬤ Reproject</a><a class="nav-link nav-item" href="../../../../SkyCoords/">⬤ SkyCoords</a><a class="nav-link nav-item" href="../../../../WCS/">◯ WCS</a></ul></div><div class="nav-mega-column"><div class="column-header">Spectroscopy</div><ul class="column-content"><a class="nav-link nav-item" href="https://ajwheeler.github.io/Korg.jl/stable/" target="_blank">⬤ Korg</a><a class="nav-link nav-item" href="../../../../Spectra/">⬤ Spectra</a><a class="nav-link active nav-item" href="../../../">⬤ SpectralFitting</a></ul></div><div class="nav-mega-column"><div class="column-header">Time Series Analysis</div><ul class="column-content"><a class="nav-link nav-item" href="https://docs.juliadsp.org/stable/" target="_blank">⬤ DSP</a><a class="nav-link nav-item" href="../../../../LombScargle/">⬤ LombScargle</a><a class="nav-link nav-item" href="https://juliastats.github.io/TimeSeries.jl/stable" target="_blank">⬤ TimeSeries</a></ul></div><div class="nav-mega-column"><div class="column-header">Interferometry</div><ul class="column-content"><a class="nav-link nav-item" href="https://ptiede.github.io/Comrade.jl/stable/" target="_blank">⬤ Comrade</a><a class="nav-link nav-item" href="https://aplavin.github.io/Difmap.jl/test/examples.html" target="_blank">⬤ Difmap</a><a class="nav-link nav-item" href="https://github.com/emmt/OIFITS.jl?tab=readme-ov-file#support-for-oi-fits-data-in-julia" target="_blank">⬤ OIFITS</a><a class="nav-link nav-item" href="https://fabienbaron.github.io/OITOOLS.jl/dev" target="_blank">⬤ OITOOLS</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/PolarizedTypes.jl/stable/" target="_blank">⬤ PolarizedTypes</a><a class="nav-link nav-item" href="https://aplavin.github.io/VLBIData.jl/test/examples.html" target="_blank">⬤ VLBIData</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/VLBISkyModels.jl/stable/" target="_blank">⬤ VLBISkyModels</a></ul></div></div></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Statistics</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Uncertainty</div><ul class="column-content"><a class="nav-link nav-item" href="https://juliaphysics.github.io/Measurements.jl/stable/" target="_blank">⬤ Measurements</a><a class="nav-link nav-item" href="https://baggepinnen.github.io/MonteCarloMeasurements.jl/stable/" target="_blank">⬤ MonteCarloMeasurements</a><a class="nav-link nav-item" href="https://baggepinnen.github.io/MonteCarloMeasurements.jl/stable/" target="_blank">⬤ Uncertain</a></ul></div><div class="nav-mega-column"><div class="column-header">Optimization</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../BoxLeastSquares/">⬤ BoxLeastSquares</a><a class="nav-link nav-item" href="http://jump.dev/JuMP.jl/" target="_blank">⬤ JuMP</a><a class="nav-link nav-item" href="https://docs.sciml.ai/NonlinearSolve/stable/" target="_blank">⬤ NonlinearSolve</a><a class="nav-link nav-item" href="https://docs.sciml.ai/Optimization/stable/" target="_blank">⬤ Optimization</a></ul></div><div class="nav-mega-column"><div class="column-header">General</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../AstroLib/">⬤ AstroLib</a><a class="nav-link nav-item" href="http://mileslucas.com/BiweightStats.jl/stable/" target="_blank">⬤ BiweightStats</a><a class="nav-link nav-item" href="https://github.com/jeff-regier/Celeste.jl/wiki/" target="_blank">⬤ Celeste</a><a class="nav-link nav-item" href="https://juliastats.org/" target="_blank">⬤ JuliaStats</a><a class="nav-link nav-item" href="https://juliastats.github.io/Distributions.jl/stable/" target="_blank">⬤ Distributions</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/FastHartleyTransform.jl/stable/" target="_blank">⬤ FastHartleyTransform</a><a class="nav-link nav-item" href="https://sefffal.github.io/Octofitter.jl/dev" target="_blank">⬤ Octofitter</a></ul></div></div></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Utilities</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Data I/O</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../ASDF2/">⬤ ASDF2</a><a class="nav-link nav-item" href="../../../../AstroImages/">⬤ AstroImages</a><a class="nav-link nav-item" href="../../../../CFITSIO/">◯ CFITSIO</a><a class="nav-link nav-item" href="https://emmt.github.io/EasyFITS.jl/dev" target="_blank">⬤ EasyFITS</a><a class="nav-link nav-item" href="../../../../FITSFiles/">⬤ FITSFiles</a><a class="nav-link nav-item" href="../../../../FITSIO/">◯ FITSIO</a><a class="nav-link nav-item" href="https://github.com/JuliaAPlavin/FixedWidthTables.jl?tab=readme-ov-file#fixedwidthtablesjl" target="_blank">⬤ FixedWidthTables</a><a class="nav-link nav-item" href="https://aplavin.github.io/SkyImages.jl/test/notebook.html" target="_blank">⬤ SkyImages</a><a class="nav-link nav-item" href="https://github.com/JuliaAPlavin/VirtualObservatory.jl?tab=readme-ov-file#virtualobservatoryjl" target="_blank">⬤ VirtualObservatory</a><a class="nav-link nav-item" href="https://github.com/JuliaAPlavin/VOTables.jl" target="_blank">⬤ VOTables</a><a class="nav-link nav-item" href="../../../../XPA/">⬤ XPA</a></ul></div><div class="nav-mega-column"><div class="column-header">Data processing</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../Astroalign/">⬤ Astroalign</a><a class="nav-link nav-item" href="../../../../BackgroundMeshes/">⬤ BackgroundMeshes</a><a class="nav-link nav-item" href="https://github.com/torrance/Casacore.jl?tab=readme-ov-file#casacorejl" target="_blank">⬤ Casacore</a><a class="nav-link nav-item" href="https://dataframes.juliadata.org/stable/" target="_blank">⬤ DataFrames</a><a class="nav-link nav-item" href="https://rafaqz.github.io/DimensionalData.jl/stable/" target="_blank">⬤ DimensionalData</a><a class="nav-link nav-item" href="https://aplavin.github.io/FlexiJoins.jl/test/examples.html" target="_blank">⬤ FlexiJoins</a><a class="nav-link nav-item" href="https://github.com/gcalderone/SortMerge.jl?tab=readme-ov-file#sortmerge" target="_blank">⬤ SortMerge</a></ul></div><div class="nav-mega-column"><div class="column-header">Data Viz</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../AstroImages/">⬤ AstroImages</a><a class="nav-link nav-item" href="https://juliaimages.github.io/ImageFiltering.jl/stable" target="_blank">⬤ ImageFiltering</a><a class="nav-link nav-item" href="https://manuelbehrendt.github.io/Mera.jl/stable/" target="_blank">⬤ Mera</a><a class="nav-link nav-item" href="https://sefffal.github.io/PairPlots.jl/dev/" target="_blank">⬤ PairPlots</a><a class="nav-link nav-item" href="https://aplavin.github.io/SkyImages.jl/test/notebook.html" target="_blank">⬤ SkyImages</a></ul></div><div class="nav-mega-column"><div class="column-header">Units/Constants</div><ul class="column-content"><a class="nav-link nav-item" href="../../../../AstroAngles/">⬤ AstroAngles</a><a class="nav-link nav-item" href="https://symbolicml.org/DynamicQuantities.jl/stable/" target="_blank">⬤ DynamicQuantities</a><a class="nav-link nav-item" href="https://juliaphysics.github.io/PhysicalConstants.jl/stable/" target="_blank">⬤ PhysicalConstants</a><a class="nav-link nav-item" href="https://painterqubits.github.io/Unitful.jl/stable" target="_blank">⬤ Unitful</a><a class="nav-link nav-item" href="../../../../UnitfulAstro/">⬤ UnitfulAstro</a></ul></div></div></div><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img alt="SpectralFitting.jl logo" src="../../assets/logo.svg"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SpectralFitting.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../walkthrough/">Walkthrough</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Diverse examples</a></li><li><a class="tocitem" href="../../examples/sherpa-example/">A quick guide</a></li></ul></li><li><span class="tocitem">Fitting</span><ul><li><a class="tocitem" href="../../parameters/">Parameters</a></li></ul></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../../models/using-models/">Using models</a></li><li><a class="tocitem" href="../../models/models/">Model index</a></li><li><a class="tocitem" href="../../models/composite-models/">Composite models</a></li><li><a class="tocitem" href="../../models/wrapper-models/">Wrapper models</a></li><li><a class="tocitem" href="../../models/surrogate-models/">Surrogate models</a></li><li><a class="tocitem" href="../../models/xspec-models/">XSPEC models</a></li></ul></li><li><span class="tocitem">Datasets</span><ul><li class="is-active"><a class="tocitem" href="">Using datasets</a><ul class="internal"><li><a class="tocitem" href="#Dataset-abstraction"><span>Dataset abstraction</span></a></li><li><a class="tocitem" href="#Underlying-data-layouts"><span>Underlying data layouts</span></a></li></ul></li><li><a class="tocitem" href="../mission-support/">Mission support</a></li></ul></li><li><a class="tocitem" href="../../why-and-how/">Why &amp; How</a></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Datasets</a></li><li class="is-active"><a href="">Using datasets</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Using datasets</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAstro/SpectralFitting.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/main/docs/src/datasets/datasets.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Datasets"><a class="docs-heading-anchor" href="#Datasets">Datasets</a><a id="Datasets-1"></a><a class="docs-heading-anchor-permalink" href="#Datasets" title="Permalink"></a></h1><p>SpectralFitting.jl supports a wide variety of datasets, and makes it easy to wrap your own.</p><p>For spectral fitting specifics, the main dataset type is</p><article><details class="docstring" open="true"><summary id="SpectralFitting.SpectralData"><a class="docstring-binding" href="#SpectralFitting.SpectralData"><code>SpectralFitting.SpectralData</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">SpectralData{T} &lt;: AbstractDataset</code></pre><p>A general spectral data structure, minimally with a <a href="@ref"><code>Spectrum</code></a> and <a href="@ref"><code>ResponseMatrix</code></a>. Optionally also includes the <a href="@ref"><code>AncillaryResponse</code></a> and a background <a href="@ref"><code>Spectrum</code></a>.</p><p><strong>Methods</strong></p><p>The following methods are made available through the <code>SpectralData</code>:</p><ul><li><a href="@ref"><code>regroup!</code></a></li><li><a href="@ref"><code>restrict_domain!</code></a></li><li><a href="@ref"><code>mask_energies!</code></a></li><li><a href="@ref"><code>drop_channels!</code></a></li><li><a href="@ref"><code>drop_bad_channels!</code></a></li><li><a href="@ref"><code>drop_negative_channels!</code></a></li><li><a href="@ref"><code>normalize!</code></a></li><li><a href="@ref"><code>objective_units</code></a></li><li><a href="@ref"><code>spectrum_energy</code></a></li><li><a href="@ref"><code>bin_widths</code></a></li><li><a href="@ref"><code>subtract_background!</code></a></li><li><a href="@ref"><code>set_domain!</code></a></li><li><a href="@ref"><code>error_statistic</code></a></li></ul><p><strong>Constructors</strong></p><p>The available constructors are:</p><pre><code class="language-julia hljs">SpectralData(paths::SpectralDataPaths; kwargs...)</code></pre><p>Using <a href="@ref"><code>SpectralDataPaths</code></a>.</p><p>If the spectrum and repsonse matrix have already been loaded seperately, use</p><pre><code class="language-julia hljs">SpectralData(
    spectrum::Spectrum,
    response::ResponseMatrix;
    # try to match the domains of the response matrix to the data
    match_domains = true,
    background = nothing,
    ancillary = nothing,
)</code></pre></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/datasets/spectraldata.jl#L43-L87" target="_blank">source</a></section></details></article><h2 id="Dataset-abstraction"><a class="docs-heading-anchor" href="#Dataset-abstraction">Dataset abstraction</a><a id="Dataset-abstraction-1"></a><a class="docs-heading-anchor-permalink" href="#Dataset-abstraction" title="Permalink"></a></h2><p>Datasets must define a small API to make fitting possible. The picture to have in mind when considering the different domains is as follows: the model is trying to predict the objective. It does so by taking in input domain and maps it to some output domain.</p><p>That means <a href="#SpectralFitting.make_output_domain"><code>make_output_domain</code></a> and <a href="@ref"><code>make_objective_domain</code></a> correspond to the <span>$(X,Y)$</span> values of the data that the model is trying to fit, whilst the model is evaluated on the <a href="#SpectralFitting.make_model_domain"><code>make_model_domain</code></a>, which need not be the same as the output domain.</p><p>In other cases, the <a href="@ref"><code>objective_transformer</code></a> acts to transform the output of the model onto the output domain. </p><p>Mathematically, expressing the output domain <span>$X$</span>, the model domain <span>$D$</span>, the model output <span>$M(D)$</span> and objective <span>$S$</span>, along with the transformer as <span>$T$</span>, then the relationship between the different domains is</p><p class="math-container">\[\hat{S} = T \times M(D),\]</p><p>Both <span>$\hat{S}$</span> and <span>$S$</span> are defined over <span>$X$</span>. The various fitting operations try to find model paramters that make <span>$\hat{S}$</span> and <span>$S$</span> as close as possible.</p><article><details class="docstring" open="true"><summary id="SpectralFitting.AbstractDataset"><a class="docstring-binding" href="#SpectralFitting.AbstractDataset"><code>SpectralFitting.AbstractDataset</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractDataset</code></pre><p>Abstract type for use in fitting routines. High level representation of some underlying data structures.</p><p>Fitting data is considered to have an <em>objective</em> and a <em>domain</em>. As the domain may be, for example, energy bins (high and low), or fourier frequencies (single value), the purpose of this abstraction is to provide some facility for translating between these representations for the models to fit with. This is done by checking that the <a href="#SpectralFitting.AbstractDataLayout"><code>AbstractDataLayout</code></a> of the model and data are compatible, or at least have compatible translations.</p><p>Must implement a minimal set of accessor methods. These are paired with <code>objective</code> and <code>domain</code> parlance. Note that these functions are prefixed with <code>make_*</code> and not <code>get_*</code> to represent that there may be allocations or work going into the translation. Usage of these functions should be sparse in the interest of performance.</p><p>The arrays returned by the <code>make_*</code> functions must correspond to the <a href="#SpectralFitting.AbstractDataLayout"><code>AbstractDataLayout</code></a> specified by the caller.</p><ul><li><a href="#SpectralFitting.make_objective_variance"><code>make_objective_variance</code></a></li><li><a href="#SpectralFitting.make_objective"><code>make_objective</code></a></li><li><a href="#SpectralFitting.make_domain_variance"><code>make_domain_variance</code></a></li><li><a href="#SpectralFitting.make_model_domain"><code>make_model_domain</code></a></li><li><a href="@ref"><code>make_ouput_domain</code></a></li></ul><p>Additionally there is an objective transformer that transforms the output of the model onto the <code>output</code> domain:</p><ul><li><a href="@ref"><code>objective_transformer</code></a></li></ul><p>Finally, to make all of the fitting for different statistical regimes work efficiently, datasets should inform which units are preferred to fit. They may also give the error statistics they prefer, and a label name primarily used to disambiguate:</p><ul><li><a href="@ref"><code>preferred_units</code></a></li><li><a href="@ref"><code>error_statistic</code></a></li><li><a href="@ref"><code>make_label</code></a></li></ul></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/datasets/datasets.jl#L1-L42" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.make_objective_variance"><a class="docstring-binding" href="#SpectralFitting.make_objective_variance"><code>SpectralFitting.make_objective_variance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">make_objective_variance(layout::AbstractDataLayout, dataset::AbstractDataset)</code></pre><p>Make the variance vector associated with each objective point.</p></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/datasets/datasets.jl#L72-L76" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.make_objective"><a class="docstring-binding" href="#SpectralFitting.make_objective"><code>SpectralFitting.make_objective</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">make_objective(layout::AbstractDataLayout, dataset::AbstractDataset)</code></pre><p>Returns the array used as the target for model fitting. The array must correspond to the data <a href="#SpectralFitting.AbstractDataLayout"><code>AbstractDataLayout</code></a> specified by the <code>layout</code> parameter.</p><p>In as far as it can be guarunteed, the memory in the returned array will not be mutated by any fitting procedures.</p><p>Domain for this objective should be returned by <a href="#SpectralFitting.make_model_domain"><code>make_model_domain</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/datasets/datasets.jl#L57-L68" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.make_domain_variance"><a class="docstring-binding" href="#SpectralFitting.make_domain_variance"><code>SpectralFitting.make_domain_variance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">make_domain_variance(layout::AbstractDataLayout, dataset::AbstractDataset)</code></pre><p>Make the variance vector associated with the domain.</p></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/datasets/datasets.jl#L89-L93" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.make_model_domain"><a class="docstring-binding" href="#SpectralFitting.make_model_domain"><code>SpectralFitting.make_model_domain</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">make_model_domain(layout::AbstractDataLayout, dataset::AbstractDataset)</code></pre><p>Returns the array used as the domain for the modelling. This is paired with <a href="#SpectralFitting.make_domain_variance"><code>make_domain_variance</code></a></p></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/datasets/datasets.jl#L80-L85" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.make_output_domain"><a class="docstring-binding" href="#SpectralFitting.make_output_domain"><code>SpectralFitting.make_output_domain</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">make_output_domain(layout::AbstractDataLayout, dataset::AbstractDataset)</code></pre><p>Returns the array used as the output domain. That is, in cases where the model input and output map to different domains, the input domain is said to be the model domain, the input domain is said to be the model domain.</p><p>The distinction is mainly used for the purposes of simulating data and for visualising data.</p></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/datasets/datasets.jl#L97-L106" target="_blank">source</a></section></details></article><h2 id="Underlying-data-layouts"><a class="docs-heading-anchor" href="#Underlying-data-layouts">Underlying data layouts</a><a id="Underlying-data-layouts-1"></a><a class="docs-heading-anchor-permalink" href="#Underlying-data-layouts" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SpectralFitting.AbstractDataLayout"><a class="docstring-binding" href="#SpectralFitting.AbstractDataLayout"><code>SpectralFitting.AbstractDataLayout</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractDataLayout end</code></pre><p>The data layout primarily concerns the relationship between the objective and the domain. It is used to work out whether a model and a dataset are fittable, and if not, whether a translation in the output of the model to the domain of the model is possible.</p><p>The following methods may be used to interrogate support:</p><ul><li><a href="#SpectralFitting.preferred_support"><code>preferred_support</code></a> for inferring the preferred support of a model when multiple supports are possible.</li><li><a href="#SpectralFitting.common_support"><code>common_support</code></a> to obtain the common support of two structures</li></ul><p>The following method is also used to define the support of a model or dataset:</p><ul><li><a href="#SpectralFitting.supports"><code>supports</code></a></li></ul><p>For cases where unit information needs to be propagated, an <code>AbstractDataLayout</code> can also be used to ensure the units are compatible. To query the units of a layout, use</p><ul><li><a href="@ref"><code>support_units</code></a></li></ul></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/support.jl#L8-L25" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.OneToOne"><a class="docstring-binding" href="#SpectralFitting.OneToOne"><code>SpectralFitting.OneToOne</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct OneToOne &lt;: AbstractDataLayout end</code></pre><p>Indicates there is a one-to-one (injective) correspondence between each input value and each output value. That is to say</p><pre><code class="language-julia hljs">length(objective) == length(domain)</code></pre></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/support.jl#L50-L58" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.ContiguouslyBinned"><a class="docstring-binding" href="#SpectralFitting.ContiguouslyBinned"><code>SpectralFitting.ContiguouslyBinned</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct ContiguouslyBinned &lt;: AbstractDataLayout end</code></pre><p>Contiguously binned data layout means that the domain describes high and low bins, with the objective being the value in that bin. This means</p><pre><code class="language-julia hljs">length(objective) + 1== length(domain)</code></pre><p>Note that the <em>contiguous</em> qualifer is to mean there is no gaps in the bins, and that</p><p class="math-container">\[\Delta E_i = E_{i+1} - E_{i}\]</p></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/support.jl#L66-L79" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.common_support"><a class="docstring-binding" href="#SpectralFitting.common_support"><code>SpectralFitting.common_support</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">common_support(x, y)</code></pre><p>Find the common <a href="#SpectralFitting.AbstractDataLayout"><code>AbstractDataLayout</code></a> of <code>x</code> and <code>y</code>, following the ordering of <a href="#SpectralFitting.preferred_support"><code>preferred_support</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/support.jl#L108-L113" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.preferred_support"><a class="docstring-binding" href="#SpectralFitting.preferred_support"><code>SpectralFitting.preferred_support</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">preferred_support(x)</code></pre><p>Get the preferred <a href="#SpectralFitting.AbstractDataLayout"><code>AbstractDataLayout</code></a> of <code>x</code>. If multiple supports are available, the <code>DEFAULT_SUPPORT_ORDERING</code> is followed:</p><pre><code class="language-julia hljs">DEFAULT_SUPPORT_ORDERING = (ContiguouslyBinned{Nothing}(nothing), OneToOne{Nothing}(nothing))</code></pre></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/support.jl#L89-L98" target="_blank">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SpectralFitting.supports"><a class="docstring-binding" href="#SpectralFitting.supports"><code>SpectralFitting.supports</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">supports(x::Type)</code></pre><p>Used to define whether a given type has support for a specific <a href="#SpectralFitting.AbstractDataLayout"><code>AbstractDataLayout</code></a>. Should return a tuple of the supported layouts. This method should be implemented to express new support, not the query method.</p><p>To query, there is</p><pre><code class="language-julia hljs">supports(layout::AbstractDataLayout, x)::Bool</code></pre><p><strong>Example</strong></p><pre><code class="language-julia hljs">supports(::Type{typeof(x)}) = (OneToOne(),)
@assert supports(ContiguouslyBinned(), x) == false</code></pre></div><a class="docs-sourcelink" href="https://github.com/JuliaAstro/SpectralFitting.jl/blob/e83fbafcb10d79e59fbd3d8ac780f009568e0aa3/src/support.jl#L147-L164" target="_blank">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../models/xspec-models/">« XSPEC models</a><a class="docs-footer-nextpage" href="../mission-support/">Mission support »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 25 November 2025 15:04">Tuesday 25 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>