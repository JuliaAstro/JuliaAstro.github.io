var documenterSearchIndex = {"docs":
[{"location":"api/#API/Reference","page":"API/Reference","title":"API/Reference","text":"","category":"section"},{"location":"api/","page":"API/Reference","title":"API/Reference","text":"","category":"page"},{"location":"api/","page":"API/Reference","title":"API/Reference","text":"","category":"page"},{"location":"api/","page":"API/Reference","title":"API/Reference","text":"lacosmic","category":"page"},{"location":"api/#LACosmic.lacosmic","page":"API/Reference","title":"LACosmic.lacosmic","text":"lacosmic(data::AbstractMatrix;\n    noise=nothing,\n    gain=1,\n    background=0,\n    readnoise=0,\n    mask=falses(size(data)),\n    sigma_clip=4.5,\n    contrast=5,\n    neighbor_thresh=0.3,\n    maxiter=4,\n    saturation_level=2^16,\n    block_size=2)\n\nLaplacian cosmic ray detection (LACosmic). This algorithm implements the algorithm presented in lacosmicx. The return values are the cleaned image and the bad pixel mask. The image cleaning is done via median interpolation.\n\nParameters\n\nnoise is the pre-determined estimate of the data noise (square root of variance), if any\ngain is the image gain in electrons per data number\nbackground is pre-determined image background, if any\nreadnoise is the read noise of the image in electrons\nmask is an input bad pixel mask, where true represents a bad pixel\nsigma_clip is the Laplacian signal-to-noise ratio for flagging bad pixels\ncontrast is the minimum contrast required to flag a bad pixel in the ratio of the Laplacian image to the fine-structure image\nneighbor_thresh is the fractional detection limit for cosmic rays surrounding other cosmic rays. Should be a number between 0 and 1.\nmaxiter is the maximum number of iterations used for detecting bad pixels\nsaturation_level is the saturation value in electrons\nblock_size is the subsampling factor for the Laplacian filter image.\n\nExamples\n\njulia> image = 100 .* randn(1001, 1001) .+ 1000;\n\njulia> clean_image, mask = lacosmic(image, gain=4);\n\nReferences\n\nvan Dokkum, P.G. (2001) - \"Cosmic-Ray Rejection by Laplacian Edge Detection\"\n\n\n\n\n\n","category":"function"},{"location":"examples/#Examples","page":"Examples","title":"Examples","text":"","category":"section"},{"location":"examples/#Setup","page":"Examples","title":"Setup","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"You will need the following packages installed to replicate this tutorial","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"julia> ] # pressing ']' should drop you into pkg-mode\npkg> add Distributions LACosmic Plots PSFModels","category":"page"},{"location":"examples/#Removing-bad-pixels-with-LACosmic.jl","page":"Examples","title":"Removing bad pixels with LACosmic.jl","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"First, let's create some fake data with Gaussian sources","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"using Distributions\nusing PSFModels: gaussian\nusing Random\n\nfunction make_data(rng, N; N_sources=20, N_cosmics=20)\n    imdata = fill(200.0, (N, N))\n\n    # Add some fake sources\n    for _ in 1:N_sources\n        x = rand(rng, Uniform(1, N + 1))\n        y = rand(rng, Uniform(1, N + 1))\n        brightness = rand(rng, Uniform(1000, 30000)) / (2Ï€ * 3.5^2)\n        model = gaussian(;x, y, fwhm=3.5, amp=brightness)\n        imdata .+= model.(axes(imdata)...)\n    end\n\n    # Add the poisson noise\n    imdata .= rand.(rng, Poisson.(imdata))\n\n    # Add readnoise\n    imdata .+= rand(rng, Normal(0, 10), (N, N))\n\n    clean_image = copy(imdata)\n\n    # Add Nc fake cosmic rays\n    crmask = falses((N, N))\n    for i in 1:N_cosmics\n        cr_x = round(Int, rand(rng, Uniform(6, N - 5)))\n        cr_y = round(Int, rand(rng, Uniform(6, N - 5)))\n        cr_brightnesses = rand(rng, Uniform(1000, 30000))\n        imdata[cr_y, cr_x] += cr_brightnesses\n        crmask[cr_y, cr_x] = true\n    end\n\n    # Make a mask where the detected cosmic rays should be\n    return (image=imdata, clean_image, mask=crmask)\nend\n\nrng = MersenneTwister(808)\ndata = make_data(rng, 201)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"let's inspect it","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"using Plots\n\nfunction imshow(image; kwargs...)\n    axy, axx = axes(image)\n    heatmap(axy, axx, image;\n            aspect_ratio=1,\n            ticks=false,\n            xlim=extrema(axx),\n            ylim=extrema(axy),\n            kwargs...)\nend\n\nplot(\n    imshow(log10.(data.clean_image), title=\"original image\"),\n    imshow(log10.(data.image), title=\"image w/cosmics\"),\n    size=(775, 350)\n)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"now we can clean it using lacosmic","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"using LACosmic\n\nclean_image, mask = lacosmic(data.image, sigma_clip=6, contrast=5, neighbor_thresh=1)\n\nplot(\n    imshow(log10.(data.clean_image), title=\"original image\"),\n    imshow(log10.(clean_image), title=\"cleaned image\"),\n    size=(775, 350)\n)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"plot(\n    imshow(data.mask, title=\"true cosmics\", cbar=false),\n    imshow(mask, title=\"detected cosmics\", cbar=false),\n    size=(700, 400)\n)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"data.mask == mask","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = LACosmic","category":"page"},{"location":"#LACosmic.jl","page":"Home","title":"LACosmic.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"(Image: Code) (Image: Build Status) (Image: PkgEval) (Image: Coverage) (Image: License)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Laplacian cosmic-ray detection (L.A.Cosmic) in pure Julia.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To use the LACosmic library, first install it using Pkg","category":"page"},{"location":"","page":"Home","title":"Home","text":"julia> ] # pressing ']' should drop you into pkg-mode\npkg> add LACosmic","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To import the library","category":"page"},{"location":"","page":"Home","title":"Home","text":"using LACosmic","category":"page"},{"location":"","page":"Home","title":"Home","text":"there is one exported function: lacosmic","category":"page"},{"location":"","page":"Home","title":"Home","text":"clean_image, mask = lacosmic(image)","category":"page"},{"location":"#Performance","page":"Home","title":"Performance","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"This code has been benchmarked against the Cython implementation in Astro-SCRAPPY. This benchmark simply computes the time it takes to run the LACosmic algorithm with different image sizes. The size is the length of one dimension of the image, so the expected scaling should be propto N^2. The code can be found in bench/benchmark.jl. Here is the information for my system-","category":"page"},{"location":"","page":"Home","title":"Home","text":"Julia Version 1.6.0\nCommit f9720dc2eb* (2021-03-24 12:55 UTC)\nPlatform Info:\n  OS: macOS (x86_64-apple-darwin20.3.0)\n  CPU: Intel(R) Core(TM) i5-8259U CPU @ 2.30GHz\n  WORD_SIZE: 64\n  LIBM: libopenlibm\n  LLVM: libLLVM-11.0.1 (ORCJIT, skylake)\nEnvironment:\n  OMP_NUM_THREADS = 1\n  JULIA_NUM_THREADS = 1","category":"page"},{"location":"","page":"Home","title":"Home","text":"using CSV, DataFrames, Plots, LaTeXStrings # hide\nusing LACosmic # hide\nbenchdir = joinpath(pkgdir(LACosmic), \"bench\") # hide\nresults = CSV.read(joinpath(benchdir, \"benchmark_results.csv\"), DataFrame) # hide\n\nplot(results.N_data, [results.t_python results.t_julia]; # hide\n    label=[\"Astro-SCRAPPY\" \"LACosmic.jl\"], leg=:topleft, # hide\n    xlabel=\"image size\", ylabel=\"time (s)\", # hide\n    yscale=:log10, shape=:o) # hide\npoints = range(extrema(results.N_data)..., length=51) # hide\nfactor = results.t_julia[begin] / (results.N_data[begin])^2 # hide\nplot!(points, t -> t^2 * factor, ls=:dash, c=:black, alpha=0.3, lab=L\"\\propto N^2\") # hide\n","category":"page"},{"location":"#Contributing-and-Support","page":"Home","title":"Contributing and Support","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"If you would like to contribute, feel free to open a pull request. If you want to discuss something before contributing, head over to discussions and join or open a new topic. If you're having problems with something, please open an issue.","category":"page"}]
}
