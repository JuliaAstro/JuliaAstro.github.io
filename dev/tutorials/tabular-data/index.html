<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Working with tabular data · JuliaAstro</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://juliaastro.github.io/tutorials/tabular-data/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="JuliaAstro logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuliaAstro</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../jwst-image-scale-bar/">JWST image with scale bar</a></li><li class="is-active"><a class="tocitem" href>Working with tabular data</a><ul class="internal"><li><a class="tocitem" href="#Packages"><span>Packages</span></a></li><li><a class="tocitem" href="#Downloading-the-data"><span>Downloading the data</span></a></li><li><a class="tocitem" href="#Loading-the-table"><span>Loading the table</span></a></li><li><a class="tocitem" href="#Examining-the-table"><span>Examining the table</span></a></li><li><a class="tocitem" href="#Filtering"><span>Filtering</span></a></li><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li></ul></li><li><a class="tocitem" href="../curve-fit/">Curve Fitting</a></li></ul></li></ul></li><li><span class="tocitem">Time, Coordinates, &amp; Units</span><ul><li><a class="tocitem" href="../../highlevels/timecoords/">Time, Coordinates, &amp; Units Overview</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">AstroLib</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/AstroLib/">Introduction</a></li><li><a class="tocitem" href="../../modules/AstroLib/ref/">Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">UnitfulAstro</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/UnitfulAstro/">Home</a></li></ul></li><li><a class="tocitem" href="../../modules/AstroAngles/">AstroAngles</a></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">AstroTime</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/AstroTime/">Home</a></li><li><a class="tocitem" href="../../modules/AstroTime/tutorial/">Tutorial</a></li><li><input class="collapse-toggle" id="menuitem-3-5-3" type="checkbox"/><label class="tocitem" for="menuitem-3-5-3"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/AstroTime/api/timescales/">Time Scales</a></li><li><a class="tocitem" href="../../modules/AstroTime/api/periods/">Periods</a></li><li><a class="tocitem" href="../../modules/AstroTime/api/epochs/">Epochs</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">SkyCoords</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/SkyCoords/">Home</a></li><li><a class="tocitem" href="../../modules/SkyCoords/api/">API/Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">WCS</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/WCS/">Home</a></li></ul></li></ul></li><li><span class="tocitem">Images</span><ul><li><a class="tocitem" href="../../highlevels/images/">Images Overview</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">AstroImages</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/AstroImages/">Home</a></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/AstroImages/manual/getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/loading-images/">Loading &amp; Saving Images</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/displaying-images/">Displaying Images</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/array/">Array Operations</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/headers/">Headers</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/dimensions-and-world-coordinates/">Dimensions and World Coordinates</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/polarization/">Polarization</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/spec/">Spectral Axes</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/preserving-wrapper/">Preserving Wrapper</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/conventions/">Conventions</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/converting-to-rgb/">Converting to RGB</a></li><li><a class="tocitem" href="../../modules/AstroImages/manual/converting-from-rgb/">Converting from RGB</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2-3" type="checkbox"/><label class="tocitem" for="menuitem-4-2-3"><span class="docs-label">Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/AstroImages/guide/image-filtering/">Blurring &amp; Filtering Images</a></li><li><a class="tocitem" href="../../modules/AstroImages/guide/image-transformations/">Transforming Images</a></li><li><a class="tocitem" href="../../modules/AstroImages/guide/reproject/">Reprojecting Images</a></li><li><a class="tocitem" href="../../modules/AstroImages/guide/photometry/">Extracting Photometry</a></li><li><a class="tocitem" href="../../modules/AstroImages/guide/contours/">Plotting Contours</a></li></ul></li><li><a class="tocitem" href="../../modules/AstroImages/api/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">SAOImageDS9</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/SAOImageDS9/">Introduction</a></li><li><a class="tocitem" href="../../modules/SAOImageDS9/install/">Installation</a></li><li><a class="tocitem" href="../../modules/SAOImageDS9/starting/">Starting</a></li><li><a class="tocitem" href="../../modules/SAOImageDS9/requests/">SAOImage/DS9 requests</a></li><li><a class="tocitem" href="../../modules/SAOImageDS9/connect/">Connection to a specific server</a></li><li><a class="tocitem" href="../../modules/SAOImageDS9/drawing/">Drawing in SAOImage/DS9</a></li><li><a class="tocitem" href="../../modules/SAOImageDS9/examples/">Examples</a></li><li><a class="tocitem" href="../../modules/SAOImageDS9/library/">Package library</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Photometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/Photometry/">Home</a></li><li><input class="collapse-toggle" id="menuitem-4-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-4-2"><span class="docs-label">Background Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/Photometry/background/">Getting Started</a></li><li><a class="tocitem" href="../../modules/Photometry/background/estimators/">Background Estimators</a></li><li><a class="tocitem" href="../../modules/Photometry/background/interpolators/">Background Interpolators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-4-3"><span class="docs-label">Source Detection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/Photometry/detection/">Getting Started</a></li><li><a class="tocitem" href="../../modules/Photometry/detection/algs/">Algorithms</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4-4"><span class="docs-label">Aperture Photometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/Photometry/apertures/">Getting Started</a></li><li><a class="tocitem" href="../../modules/Photometry/apertures/apertures/">Apertures</a></li><li><a class="tocitem" href="../../modules/Photometry/apertures/examples/">Examples</a></li></ul></li></ul></li><li><a class="tocitem" href="../../modules/PSFModels/">PSFModels</a></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">LACosmic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/LACosmic/">Home</a></li><li><a class="tocitem" href="../../modules/LACosmic/examples/">Examples</a></li><li><a class="tocitem" href="../../modules/LACosmic/api/">API/Reference</a></li></ul></li></ul></li><li><span class="tocitem">Data I/O</span><ul><li><a class="tocitem" href="../../highlevels/dataio/">Data I/O Overview</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">FITSIO</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/FITSIO/">Introduction</a></li><li><a class="tocitem" href="../../modules/FITSIO/api/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">CFITSIO</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/CFITSIO/">Home</a></li></ul></li><li><a class="tocitem" href="../../modules/CasaCore/">CasaCore</a></li><li><a class="tocitem" href="../../modules/OIFITS/">OIFITS</a></li><li><a class="tocitem" href="../../modules/VLBIData/">VLBIData</a></li><li><a class="tocitem" href="../../modules/Difmap/">Difmap</a></li></ul></li><li><span class="tocitem">Cosmology</span><ul><li><a class="tocitem" href="../../highlevels/cosmology/">Cosmology Overview</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Cosmology</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/Cosmology/">Home</a></li><li><a class="tocitem" href="../../modules/Cosmology/api/">API/Reference</a></li></ul></li></ul></li><li><span class="tocitem">Orbits &amp; Emphemerides</span><ul><li><a class="tocitem" href="../../highlevels/orb-ephem/">Orbits &amp; Ephemerides Overview</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">EarthOrientation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/EarthOrientation/">Home</a></li><li><a class="tocitem" href="../../modules/EarthOrientation/api/">API</a></li></ul></li><li><a class="tocitem" href="../../modules/Transits/">Transits</a></li><li><a class="tocitem" href="../../modules/PlanetOrbits/">PlanetOrbits</a></li><li><input class="collapse-toggle" id="menuitem-7-5" type="checkbox"/><label class="tocitem" for="menuitem-7-5"><span class="docs-label">AstroLib</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/AstroLib/">Introduction</a></li><li><a class="tocitem" href="../../modules/AstroLib/ref/">Reference</a></li></ul></li></ul></li><li><span class="tocitem">Numerical Utilities</span><ul><li><a class="tocitem" href="../../highlevels/numerical-utils/">Numerical Utilities Overview</a></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">BoxLeastSquares</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/BoxLeastSquares/">Home</a></li><li><a class="tocitem" href="../../modules/BoxLeastSquares/api/">API/Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">LombScargle</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../modules/LombScargle/">Home</a></li></ul></li></ul></li><li><span class="tocitem">Statistics</span><ul><li><a class="tocitem" href="../../highlevels/stats/">Statistics Overview</a></li><li><a class="tocitem" href="../../modules/PairPlots/">PairPlots</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">General</a></li><li class="is-active"><a href>Working with tabular data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Working with tabular data</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaAstro/JuliaAstro.github.io/blob/source/docs/src/tutorials/tabular-data.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="tabular-data"><a class="docs-heading-anchor" href="#tabular-data">Working with tabular data</a><a id="tabular-data-1"></a><a class="docs-heading-anchor-permalink" href="#tabular-data" title="Permalink"></a></h1><p>Tables are a common way to represent various forms of catalogs. One common format for storing this data in astronomy is as a FITS file.</p><p>In these examples, we will fetch and load the Hipparcos-GAIA Catalog of Accelerations [(HGCA, Brandt et al 2021])](https://iopscience.iop.org/article/10.3847/1538-4365/abf93c). This catalog cross matches stars from the Hipparcos and GAIA catalogs in order to calculate the long term astrometric proper motion anomaly; that is, the star&#39;s deviation from straight line motion in the plane of the sky over the ~20 baseline between the two missions.</p><p>A wide range of tabular data formats are supported in Julia under a common <a href="https://tables.juliadata.org">Tables.jl interface</a>. For example,  <a href="https://github.com/JuliaData/CSV.jl.git">CSV</a>, <a href="https://github.com/felipenoris/XLSX.jl.git">Excel</a>, <a href="https://github.com/apache/arrow-julia">Arrow</a>, <a href="http://mweastwood.info/CasaCore.jl/stable/">CASA Tables</a>, and various SQL formats to name a few.</p><h2 id="Packages"><a class="docs-heading-anchor" href="#Packages">Packages</a><a id="Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Packages" title="Permalink"></a></h2><ul><li><a href="http://juliaastro.org/FITSIO.jl/stable/"><code>FITSIO</code></a>: we&#39;ll use this package to load a table stored in a FITS file</li><li><a href="https://dataframes.juliadata.org/stable/"><code>DataFrames</code></a>: we&#39;ll use this package to examine and manipulate the table</li><li><a href="https://docs.juliaplots.org/latest/"><code>Plots</code></a>: we&#39;ll use this package to visualize the contents of the table</li><li><a href="https://juliaastro.org/AstroLib.jl/stable/"><code>AstroLib</code></a>: general utility package. We&#39;ll use a helper function to compute a map projection.</li></ul><p>You can install the necessary packages by running Julia, and typing <code>]</code> to enter Pkg-mode. Then: <code>add FITSIO DataFrames Plots AstroLib</code>. Alternatively, you can run <code>using Pkg; Pkg.add([&quot;FITSIO&quot;, &quot;DataFrames&quot;, &quot;Plots&quot;, &quot;AstroLib&quot;])</code>.</p><p>If you will be using these tools as part of a larger project, it&#39;s strongly recommended to create a <a href="https://pkgdocs.julialang.org/v1/environments/">Julia Project</a> to record package versions.  If you&#39;re just experimenting, you can create a temporary project by running <code>] activate --temp</code>.</p><p>If you&#39;re using <a href="https://github.com/fonsp/Pluto.jl">Pluto notebooks</a>, installing and recording package versions in a project are handled for you automatically.</p><h2 id="Downloading-the-data"><a class="docs-heading-anchor" href="#Downloading-the-data">Downloading the data</a><a id="Downloading-the-data-1"></a><a class="docs-heading-anchor-permalink" href="#Downloading-the-data" title="Permalink"></a></h2><p>The table in question is hosted alongside the <a href="https://iopscience.iop.org/article/10.3847/1538-4365/abf93c">article</a>. Go to Table 4 and click the link at the bottom to download it in FITS format. You&#39;ll need to uncompress the archive to see the <code>HGCA_vEDR3.fits</code> file.</p><p>FITS tables can be loaded using the <a href="http://juliaastro.org/FITSIO.jl/stable/">FITSIO</a> package or the <a href="http://juliaastro.org/AstroImages.jl/dev/">AstroImages</a> package which wraps it.</p><h2 id="Loading-the-table"><a class="docs-heading-anchor" href="#Loading-the-table">Loading the table</a><a id="Loading-the-table-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-the-table" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs">julia&gt; using FITSIO
julia&gt; fits = FITS(&quot;HGCA_vEDR3.fits&quot;)

File: HGCA_vEDR3.fits
Mode: &quot;r&quot; (read-only)
HDUs: Num  Name  Type   
      1          Image  
      2          Table
julia&gt; table_fits = fits[2]
File: HGCA_vEDR3.fits
HDU: 2
Type: Table
Rows: 115346
Columns: Name                    Size  Type     TFORM  
         hip_id                        Int32    J
         gaia_source_id                Int64    K
         gaia_ra                       Float64  D
         gaia_dec                      Float64  D
         radial_velocity               Float32  E
...
         chisq                         Float32  E</code></pre><p>If we choose to use the AstroImages package, this code could be substituted for:</p><pre><code class="language-julia-repl hljs">julia&gt; using AstroImages
julia&gt; table_fits = load(&quot;HGCA_vEDR3.fits&quot;, 2);</code></pre><p>Since this table conforms to the Tables.jl interface we can already pass it to a wide range of analysis and plotting tools; however, for interactive work it&#39;s useful to wrap this data in a <code>DataFrame</code> from <a href="https://dataframes.juliadata.org/stable/">DataFrames.jl</a>.</p><pre><code class="language-julia-repl hljs">julia&gt; using DataFrames
julia&gt; df = DataFrame(table_fits)
115346×35 DataFrame
    Row │ hip_id  gaia_source_id       gaia_ra        gaia_dec ⋯
        │ Int32   Int64                Float64        Float64  ⋯
────────┼───────────────────────────────────────────────────────
      1 │      1  2738327528519591936    0.000871957    1.0889 ⋯
      2 │      2  2341871673090078592    0.00511158   -19.4988  
      3 │      3  2881742980523997824    0.00506023    38.8593  
      4 │      4  4973386040722654336    0.00907157   -51.8935  
      5 │      5  2305974989264598272    0.00997423   -40.5912 ⋯
   ⋮    │   ⋮              ⋮                 ⋮            ⋮    ⋱
 115343 │ 120401  5290738562888564736  119.382        -60.6309  
 115344 │ 120402  5290832364972775808  119.449        -60.6097  
 115345 │ 120403  5290725643625189504  119.455        -60.6836  
 115346 │ 120404  5290820682661822848  119.512        -60.6147 ⋯
                              32 columns and 115337 rows omitted
</code></pre><h2 id="Examining-the-table"><a class="docs-heading-anchor" href="#Examining-the-table">Examining the table</a><a id="Examining-the-table-1"></a><a class="docs-heading-anchor-permalink" href="#Examining-the-table" title="Permalink"></a></h2><p>As a first step, let&#39;s summarize the contents of the data frame using <code>describe</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; describe(df)
35×7 DataFrame
 Row │ variable                mean         min            median       max                  nmissing  eltype   
     │ Symbol                  Union…       Any            Union…       Any                  Int64     DataType 
─────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ hip_id                  59162.8      1              59133.5      120404                      0  Int32
   2 │ gaia_source_id          3.5587e18    7632157690368  3.58418e18   6917489002841762304         0  Int64
   3 │ gaia_ra                 181.445      0.000871957    181.843      359.982                     0  Float64
   4 │ gaia_dec                -2.13495     -89.7824       -1.96568     89.5695                     0  Float64
   5 │ radial_velocity         NaN          NaN                         NaN                         0  Float32
   6 │ radial_velocity_error   NaN          NaN                         NaN                         0  Float32
   7 │ radial_velocity_source               Gaia_DR2                    None                        0  String
   8 │ parallax_gaia           6.98091      0.1            4.29612      768.067                     0  Float32
   9 │ parallax_gaia_error     0.0450278    0.00802848     0.023354     1.52339                     0  Float32
  10 │ pmra_gaia               -1.43563     -4406.47       -1.73408     6766.0                      0  Float32
  11 │ pmdec_gaia              -16.3946     -5817.8        -5.53577     10362.4                     0  Float32
  12 │ pmra_gaia_error         0.062217     0.00743185     0.0326008    2.03418                     0  Float32
  13 │ pmdec_gaia_error        0.0574897    0.00869586     0.029098     1.99573                     0  Float32
  14 │ pmra_pmdec_gaia         -0.0142746   -0.971819      -0.0116653   0.891564                    0  Float32
  15 │ pmra_hg                 -1.43057     -4406.68       -1.69382     6765.91                     0  Float32
  ⋮  │           ⋮                  ⋮             ⋮             ⋮                ⋮              ⋮         ⋮
  22 │ pmra_hip_error          1.22346      0.290212       0.93546      2269.23                     0  Float32
  23 │ pmdec_hip_error         1.00177      0.289527       0.794942     113.61                      0  Float32
  24 │ pmra_pmdec_hip          0.00441718   -0.94068       0.000400515  0.986897                    0  Float32
  25 │ epoch_ra_gaia           2016.07      2015.11        2016.07      2017.05                     0  Float64
  26 │ epoch_dec_gaia          2016.09      2014.95        2016.1       2017.2                      0  Float64
  27 │ epoch_ra_hip            1991.25      1990.4         1991.25      1992.43                     0  Float64
  28 │ epoch_dec_hip           1991.28      1990.34        1991.28      1992.41                     0  Float64
  29 │ crosscal_pmra_hip       -0.0578266   -1.36874       -0.0648208   1.50959                     0  Float32
  30 │ crosscal_pmdec_hip      0.00226569   -1.15742       0.00306844   1.59232                     0  Float32
  31 │ crosscal_pmra_hg        -0.0013262   -0.0511373     -0.00269026  0.0619938                   0  Float32
  32 │ crosscal_pmdec_hg       0.000217839  -0.0598967     0.00025581   0.0564424                   0  Float32
  33 │ nonlinear_dpmra         -9.0424e-5   -7.98001       3.44128e-8   2.64822                     0  Float32
  34 │ nonlinear_dpmdec        0.000311498  -4.1194        1.92019e-7   16.0394                     0  Float32
  35 │ chisq                   566.555      3.11559e-5     3.35103      3.67633e5                   0  Float32
                                                                                                  6 rows omitted
</code></pre><p>This lists all the columns of the table along with their min, max, median, and means. It also specifies how many entries are <a href="https://docs.julialang.org/en/v1/manual/missing/"><code>missing</code></a> and the element type of the column.</p><p>We can access a specific column from the table using two different syntaxes: <code>df[:,&quot;epoch_ra_gaia&quot;]</code>, or simply <code>df.epoch_ra_gaia</code>.</p><h2 id="Filtering"><a class="docs-heading-anchor" href="#Filtering">Filtering</a><a id="Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering" title="Permalink"></a></h2><p>Let&#39;s apply a cut to the parallax column to only include nearby stars:</p><pre><code class="language-julia-repl hljs">julia&gt; nearby = filter(:parallax_gaia =&gt; &gt;(50.0), df)
799×35 DataFrame
 Row │ hip_id  gaia_source_id       gaia_ra    gaia_dec   radial_velocity  radial_vel ⋯
     │ Int32   Int64                Float64    Float64    Float32          Float32    ⋯
─────┼─────────────────────────────────────────────────────────────────────────────────
   1 │    428   386655019234959872    1.30108   45.7859          -1.24273             ⋯
   2 │    436  4706630501049679744    1.32232  -67.8351          40.2364
   3 │    439  2306965202564744064    1.38379  -37.3675          25.2944
   4 │    473   386653851004022144    1.42676   45.8114           1.15092
  ⋮  │   ⋮              ⋮               ⋮          ⋮             ⋮                    ⋱
 796 │ 117779  2867175035571212416  358.285     29.0182           1.30031             ⋯
 797 │ 117828  6377828354964753792  358.463    -75.6342          -9.62612
 798 │ 117966  2442996678074668288  358.914     -6.14423         17.0672
 799 │ 120005  1022456104850892928  138.591     52.6834          11.9794
                                                        30 columns and 791 rows omitted</code></pre><p>Let&#39;s break this down. First, we specify the column name as <code>:parallax_gaia</code>. The <code>:</code> syntax defines a Symbol in Julia which is a bit like a string and a variable name. Next, we say what filter we want to apply to this column by passing a key-value <code>Pair</code> constructed with <code>=&gt;</code>. This syntax, e.g. <code>1 =&gt; 2</code> just groups two values and is unrelated to keyword arguments. Then, we pass a predicate function, that is a function that takes one value and returns <code>true</code> or <code>false</code>. The expression <code>&gt;(50.0)</code> produces such a function that takes a value and compares it with <code>50.0</code> milliarseconds of parallax. Finally, we pass the table we want to filter.</p><p>This <a href="https://www.ahsmart.com/pub/data-wrangling-with-data-frames-jl-cheat-sheet/">useful cheatsheet</a> by Tom Kwong is a great reference for these sort of operations.</p><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><p>Let&#39;s now visualize these stars as they appear in the plane of the sky. We&#39;ll colour them based on the significance of the anomalous acceleration they had between the two satellite missions. This acceleration could be caused by a hidden companion star or planet.</p><pre><code class="language-julia-repl hljs">julia&gt; using Plots
julia&gt; scatter(
    nearby.gaia_ra,
    nearby.gaia_dec;
    marker_z = log10.(nearby.chisq),
    colorbartitle=&quot;log10 χ²&quot;, # typed as \chi &lt;tab&gt; \^2 &lt;tab&gt;
    label = &quot;&quot;,
    xlabel = &quot;right ascension (°)&quot;, # typed as \degree &lt;tab&gt;
    ylabel = &quot;declination (°)&quot; 
)</code></pre><p>Let&#39;s improve this plot by using a different map projection. We can make this conversion using <a href="https://juliaastro.org/AstroLib.jl/stable/">AstroLib.jl</a>.</p><p>The function <a href="https://juliaastro.org/AstroLib.jl/stable/ref/#AstroLib.aitoff-Tuple{Real,%20Real}"><code>aitoff</code></a> takes longitude and latitude (or in this case, right-ascension and delcination) and returns a new position using an Aitoff projection.</p><pre><code class="language-julia-repl hljs">julia&gt; using AstroLib
julia&gt; newpoints = aitoff.(nearby.gaia_ra, nearby.gaia_dec)</code></pre><p><code>newpoints</code> is returned as a vector of <code>Tuples</code> of x and y coordinates, but to plot them we&#39;ll need separate flat vectors of x and y values. We can convert using <code>getindex</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; newx = getindex.(newpoints, 1)
julia&gt; newy = getindex.(newpoints, 2)
799-element Vector{Float64}:
  49.51360693576993
 -71.02232113037604
 -40.77386766281466
   ⋮
 -78.04105630927837
  -6.821326623255115
  64.9538084311332</code></pre><p><code>getindex(obj, n)</code> is equivalent to writing <code>obj[n]</code>. Here we use broadcasting to fetch the first and then second element of each point in the list.</p><p>Finally, we&#39;ll make the plot and tweak some formatting options:</p><pre><code class="language-julia-repl hljs">julia&gt; scatter(
    newx,
    newy;
    marker_z = log10.(nearby.chisq),
    color = :turbo,
    colorbartitle=&quot;log10 χ²&quot;, # typed as \chi &lt;tab&gt; \^2 &lt;tab&gt;
    label = &quot;&quot;,
    xlabel = &quot;right ascension (°)&quot;, # typed as \degree &lt;tab&gt;
    ylabel = &quot;declination (°)&quot;,
    background=:transparent,
    foreground=:gray,
    framestyle=:box,
    markerstrokewidth=0,
    grid=:none
)</code></pre><p><img src="../../assets/tutorials/tabular-data/starplot-1.svg" alt="Plot of nearby stars with significant acceleration"/></p><p>We can save the plot using <code>savefig(&quot;myplot.pdf&quot;)</code>. <code>png</code>, <code>svg</code>, and other formats are also supported.</p><p>For more on plotting in general, see the <a href="https://docs.juliaplots.org/latest/">Plots.jl documentation</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../jwst-image-scale-bar/">« JWST image with scale bar</a><a class="docs-footer-nextpage" href="../curve-fit/">Curve Fitting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 18 January 2023 03:23">Wednesday 18 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
