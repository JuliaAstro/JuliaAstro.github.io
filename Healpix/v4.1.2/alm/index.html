<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Spherical harmonics · Healpix.jl</title><script data-outdated-warner="" src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="https://JuliaAstro.org/Healpix/stable/alm/" rel="canonical"/><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><a class="brand" href="../../.."><img alt="home" src="../../../assets/logo.svg"/></a><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../home/">Home</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Domain</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Solar System</div><ul class="column-content"><a class="nav-link nav-item" href="../../../CALCEPH/">⬤ CALCEPH</a><a class="nav-link nav-item" href="https://juliaastro.org/EphemerisSources.jl" target="_blank">⬤ EphemerisSources</a><a class="nav-link nav-item" href="https://juliaastro.org/GeneralAstrodynamics.jl" target="_blank">⬤ GeneralAstrodynamics</a><a class="nav-link nav-item" href="https://github.com/PerezHz/HORIZONS.jl?tab=readme-ov-file#horizonsjl" target="_blank">⬤ HORIZONS</a><a class="nav-link nav-item" href="https://juliaspace.github.io/SatelliteToolbox.jl/stable/" target="_blank">⬤ SatelliteToolbox</a><a class="nav-link nav-item" href="../../../SolarPosition/">⬤ SolarPosition</a><a class="nav-link nav-item" href="../../../SPICE/">⬤ SPICE</a></ul></div><div class="nav-mega-column"><div class="column-header">Exoplanets</div><ul class="column-content"><a class="nav-link nav-item" href="http://JuliaHCI.github.io/ADI.jl/stable/" target="_blank">⬤ ADI</a><a class="nav-link nav-item" href="http://JuliaHCI.github.io/HCIToolbox.jl/stable/" target="_blank">⬤ HCIToolbox</a><a class="nav-link nav-item" href="../../../Orbits/">⬤ Orbits</a><a class="nav-link nav-item" href="https://sefffal.github.io/PlanetOrbits.jl/dev/" target="_blank">⬤ PlanetOrbits</a><a class="nav-link nav-item" href="../../../Transits/">⬤ Transits</a></ul></div><div class="nav-mega-column"><div class="column-header">Stars</div><ul class="column-content"><a class="nav-link nav-item" href="https://cgarling.github.io/BolometricCorrections.jl/stable/" target="_blank">⬤ BolometricCorrections</a><a class="nav-link nav-item" href="https://cgarling.github.io/InitialMassFunctions.jl/stable/" target="_blank">⬤ InitialMassFunctions</a><a class="nav-link nav-item" href="https://cgarling.github.io/StarFormationHistories.jl/stable/" target="_blank">⬤ StarFormationHistories</a></ul></div><div class="nav-mega-column"><div class="column-header">Galaxies and Cosmology</div><ul class="column-content"><a class="nav-link nav-item" href="../../../Cosmology/">⬤ Cosmology</a><a class="nav-link nav-item" href="../../../DustExtinction/">⬤ DustExtinction</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/ScatteringOptics.jl/stable/" target="_blank">⬤ ScatteringOptics</a></ul></div></div></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Techniques</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Photometry</div><ul class="column-content"><a class="nav-link nav-item" href="../../../CCDReduction/">⬤ CCDReduction</a><a class="nav-link nav-item" href="../../../LACosmic/">⬤ LACosmic</a><a class="nav-link nav-item" href="../../../Photometry/">⬤ Photometry</a><a class="nav-link nav-item" href="../../../PhotometricFilters/">⬤ PhotometricFilters</a><a class="nav-link nav-item" href="../../../PSFModels/">⬤ PSFModels</a><a class="nav-link nav-item" href="../../../SAOImageDS9/">⬤ SAOImageDS9</a></ul></div><div class="nav-mega-column"><div class="column-header">Astrometry</div><ul class="column-content"><a class="nav-link nav-item" href="https://barrettp.github.io/Astrometry/dev" target="_blank">⬤ Astrometry</a><a class="nav-link nav-item" href="../../../AstroTime/">⬤ AstroTime</a><a class="nav-link nav-item" href="../../../EarthOrientation/">⬤ EarthOrientation</a><a class="nav-link nav-item" href="../../../ERFA/">◯ ERFA</a><a class="nav-link active nav-item" href="../../">⬤ Healpix</a><a class="nav-link nav-item" href="../../../Reproject/">⬤ Reproject</a><a class="nav-link nav-item" href="../../../SkyCoords/">⬤ SkyCoords</a><a class="nav-link nav-item" href="../../../WCS/">◯ WCS</a></ul></div><div class="nav-mega-column"><div class="column-header">Spectroscopy</div><ul class="column-content"><a class="nav-link nav-item" href="https://ajwheeler.github.io/Korg.jl/stable/" target="_blank">⬤ Korg</a><a class="nav-link nav-item" href="../../../Spectra/">⬤ Spectra</a><a class="nav-link nav-item" href="../../../SpectralFitting/">⬤ SpectralFitting</a></ul></div><div class="nav-mega-column"><div class="column-header">Time Series Analysis</div><ul class="column-content"><a class="nav-link nav-item" href="https://docs.juliadsp.org/stable/" target="_blank">⬤ DSP</a><a class="nav-link nav-item" href="../../../LombScargle/">⬤ LombScargle</a><a class="nav-link nav-item" href="https://juliastats.github.io/TimeSeries.jl/stable" target="_blank">⬤ TimeSeries</a></ul></div><div class="nav-mega-column"><div class="column-header">Interferometry</div><ul class="column-content"><a class="nav-link nav-item" href="https://ptiede.github.io/Comrade.jl/stable/" target="_blank">⬤ Comrade</a><a class="nav-link nav-item" href="https://aplavin.github.io/Difmap.jl/test/examples.html" target="_blank">⬤ Difmap</a><a class="nav-link nav-item" href="https://github.com/emmt/OIFITS.jl?tab=readme-ov-file#support-for-oi-fits-data-in-julia" target="_blank">⬤ OIFITS</a><a class="nav-link nav-item" href="https://fabienbaron.github.io/OITOOLS.jl/dev" target="_blank">⬤ OITOOLS</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/PolarizedTypes.jl/stable/" target="_blank">⬤ PolarizedTypes</a><a class="nav-link nav-item" href="https://aplavin.github.io/VLBIData.jl/test/examples.html" target="_blank">⬤ VLBIData</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/VLBISkyModels.jl/stable/" target="_blank">⬤ VLBISkyModels</a></ul></div></div></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Statistics</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Uncertainty</div><ul class="column-content"><a class="nav-link nav-item" href="https://juliaphysics.github.io/Measurements.jl/stable/" target="_blank">⬤ Measurements</a><a class="nav-link nav-item" href="https://baggepinnen.github.io/MonteCarloMeasurements.jl/stable/" target="_blank">⬤ MonteCarloMeasurements</a><a class="nav-link nav-item" href="https://baggepinnen.github.io/MonteCarloMeasurements.jl/stable/" target="_blank">⬤ Uncertain</a></ul></div><div class="nav-mega-column"><div class="column-header">Optimization</div><ul class="column-content"><a class="nav-link nav-item" href="../../../BoxLeastSquares/">⬤ BoxLeastSquares</a><a class="nav-link nav-item" href="http://jump.dev/JuMP.jl/" target="_blank">⬤ JuMP</a><a class="nav-link nav-item" href="https://docs.sciml.ai/NonlinearSolve/stable/" target="_blank">⬤ NonlinearSolve</a><a class="nav-link nav-item" href="https://docs.sciml.ai/Optimization/stable/" target="_blank">⬤ Optimization</a></ul></div><div class="nav-mega-column"><div class="column-header">General</div><ul class="column-content"><a class="nav-link nav-item" href="../../../AstroLib/">⬤ AstroLib</a><a class="nav-link nav-item" href="http://mileslucas.com/BiweightStats.jl/stable/" target="_blank">⬤ BiweightStats</a><a class="nav-link nav-item" href="https://github.com/jeff-regier/Celeste.jl/wiki/" target="_blank">⬤ Celeste</a><a class="nav-link nav-item" href="https://juliastats.org/" target="_blank">⬤ JuliaStats</a><a class="nav-link nav-item" href="https://juliastats.github.io/Distributions.jl/stable/" target="_blank">⬤ Distributions</a><a class="nav-link nav-item" href="https://ehtjulia.github.io/FastHartleyTransform.jl/stable/" target="_blank">⬤ FastHartleyTransform</a><a class="nav-link nav-item" href="https://sefffal.github.io/Octofitter.jl/dev" target="_blank">⬤ Octofitter</a></ul></div></div></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Utilities</button><div class="nav-dropdown-container nav-mega-dropdown-container"><div class="nav-mega-column"><div class="column-header">Data I/O</div><ul class="column-content"><a class="nav-link nav-item" href="../../../ASDF2/">⬤ ASDF2</a><a class="nav-link nav-item" href="../../../AstroImages/">⬤ AstroImages</a><a class="nav-link nav-item" href="../../../CFITSIO/">◯ CFITSIO</a><a class="nav-link nav-item" href="https://emmt.github.io/EasyFITS.jl/dev" target="_blank">⬤ EasyFITS</a><a class="nav-link nav-item" href="../../../FITSFiles/">⬤ FITSFiles</a><a class="nav-link nav-item" href="../../../FITSIO/">◯ FITSIO</a><a class="nav-link nav-item" href="https://github.com/JuliaAPlavin/FixedWidthTables.jl?tab=readme-ov-file#fixedwidthtablesjl" target="_blank">⬤ FixedWidthTables</a><a class="nav-link nav-item" href="https://aplavin.github.io/SkyImages.jl/test/notebook.html" target="_blank">⬤ SkyImages</a><a class="nav-link nav-item" href="https://github.com/JuliaAPlavin/VirtualObservatory.jl?tab=readme-ov-file#virtualobservatoryjl" target="_blank">⬤ VirtualObservatory</a><a class="nav-link nav-item" href="https://github.com/JuliaAPlavin/VOTables.jl" target="_blank">⬤ VOTables</a><a class="nav-link nav-item" href="../../../XPA/">⬤ XPA</a></ul></div><div class="nav-mega-column"><div class="column-header">Data processing</div><ul class="column-content"><a class="nav-link nav-item" href="../../../Astroalign/">⬤ Astroalign</a><a class="nav-link nav-item" href="../../../BackgroundMeshes/">⬤ BackgroundMeshes</a><a class="nav-link nav-item" href="https://github.com/torrance/Casacore.jl?tab=readme-ov-file#casacorejl" target="_blank">⬤ Casacore</a><a class="nav-link nav-item" href="https://dataframes.juliadata.org/stable/" target="_blank">⬤ DataFrames</a><a class="nav-link nav-item" href="https://rafaqz.github.io/DimensionalData.jl/stable/" target="_blank">⬤ DimensionalData</a><a class="nav-link nav-item" href="https://aplavin.github.io/FlexiJoins.jl/test/examples.html" target="_blank">⬤ FlexiJoins</a><a class="nav-link nav-item" href="https://github.com/gcalderone/SortMerge.jl?tab=readme-ov-file#sortmerge" target="_blank">⬤ SortMerge</a></ul></div><div class="nav-mega-column"><div class="column-header">Data Viz</div><ul class="column-content"><a class="nav-link nav-item" href="../../../AstroImages/">⬤ AstroImages</a><a class="nav-link nav-item" href="https://juliaimages.github.io/ImageFiltering.jl/stable" target="_blank">⬤ ImageFiltering</a><a class="nav-link nav-item" href="https://manuelbehrendt.github.io/Mera.jl/stable/" target="_blank">⬤ Mera</a><a class="nav-link nav-item" href="https://sefffal.github.io/PairPlots.jl/dev/" target="_blank">⬤ PairPlots</a><a class="nav-link nav-item" href="https://aplavin.github.io/SkyImages.jl/test/notebook.html" target="_blank">⬤ SkyImages</a></ul></div><div class="nav-mega-column"><div class="column-header">Units/Constants</div><ul class="column-content"><a class="nav-link nav-item" href="../../../AstroAngles/">⬤ AstroAngles</a><a class="nav-link nav-item" href="https://symbolicml.org/DynamicQuantities.jl/stable/" target="_blank">⬤ DynamicQuantities</a><a class="nav-link nav-item" href="https://juliaphysics.github.io/PhysicalConstants.jl/stable/" target="_blank">⬤ PhysicalConstants</a><a class="nav-link nav-item" href="https://painterqubits.github.io/Unitful.jl/stable" target="_blank">⬤ Unitful</a><a class="nav-link nav-item" href="../../../UnitfulAstro/">⬤ UnitfulAstro</a></ul></div></div></div><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Healpix.jl</a></span></div><form action="../search/" class="docs-search"><input class="docs-search-query" id="documenter-search-query" name="q" placeholder="Search docs" type="text"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../resolutions/">Working with resolutions</a></li><li><a class="tocitem" href="../pixelfunc/">Pixel functions</a></li><li><a class="tocitem" href="../query/">Query functions</a></li><li><a class="tocitem" href="../mapfunc/">Map functions</a></li><li class="is-active"><a class="tocitem" href="">Spherical harmonics</a><ul class="internal"><li><a class="tocitem" href="#Converting-between-pixel-space-and-harmonic-space"><span>Converting between pixel space and harmonic space</span></a></li><li><a class="tocitem" href="#From-harmonic-coefficients-to-the-power-spectrum"><span>From harmonic coefficients to the power spectrum</span></a></li><li><a class="tocitem" href="#Loading-and-saving-harmonic-coefficients"><span>Loading and saving harmonic coefficients</span></a></li><li><a class="tocitem" href="#Full-Pixel-Weights"><span>Full Pixel Weights</span></a></li></ul></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../misc/">Miscellanea</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="">Spherical harmonics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Spherical harmonics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ziotom78/Healpix.jl/blob/master/docs/src/alm.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a></div></header><article class="content" id="documenter-page"><h1 id="Spherical-harmonics"><a class="docs-heading-anchor" href="#Spherical-harmonics">Spherical harmonics</a><a id="Spherical-harmonics-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-harmonics" title="Permalink"></a></h1><p>Starting from version 2.4, Healpix.jl implements generalized Fourier transformations through the <code>libsharp</code> library, to convert a map from its pixel-space representation to its decomposition in spherical harmonics. This has multiple applications, the most relevant being the analysis of Cosmic Microwave Background maps and the efficient computation of convolution operators.</p><p>Everything revolves around the <a href="#Healpix.Alm"><code>Alm</code></a> type, which encodes a set of spherical harmonics and is thus conceptually equivalent to the concept of a <a href="../mapfunc/#Healpix.HealpixMap"><code>HealpixMap</code></a>, only living in the harmonic space:</p><article class="docstring"><header><a class="docstring-binding" href="#Healpix.Alm" id="Healpix.Alm"><code>Healpix.Alm</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An array of harmonic coefficients (a_ℓm).</p><p>The type <code>T</code> is used for the value of each harmonic coefficient, and it must be a <code>Number</code> (one should however only use complex types for this). The type <code>AA</code> is used to store the array of coefficients; a typical choice is <code>Vector</code>.</p><p>A <code>Alm</code> type contains the following fields:</p><ul><li><code>alm</code>: the array of harmonic coefficients</li><li><code>lmax</code>: the maximum value for <span>$ℓ$</span></li><li><code>mmax</code>: the maximum value for <span>$m$</span></li><li><code>tval</code>: maximum number of <span>$m$</span> coefficients for the maximum <span>$ℓ$</span></li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/alm.jl#L3-L19" target="_blank">source</a></section></article><p>In the general case, the number of coefficients in a spherical harmonic expansion is infinite. For obvious reasons, Healpix.jl only allows to store band-limited expansions. The function <a href="#Healpix.numberOfAlms"><code>numberOfAlms</code></a> returns the number of floating-point numbers used to store the expansion, as a function of the maximum value for <span>$\ell$</span> and <span>$m$</span>.</p><article class="docstring"><header><a class="docstring-binding" href="#Healpix.numberOfAlms" id="Healpix.numberOfAlms"><code>Healpix.numberOfAlms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">numberOfAlms(lmax::Integer, mmax::Integer) -&gt; Integer
numberOfAlms(lmax::Integer) -&gt; Integer</code></pre><p>Return the size of the array of complex numbers needed to store the a_lm coefficients in the range of ℓ and m specified by <code>lmax</code> and <code>mmax</code>. If <code>mmax</code> is not specified, it is assumed to be equal to <code>lmax</code>. If <code>lmax</code> and <code>mmax</code> are inconsistent or negative, a <code>DomainError</code> exception is thrown.</p></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/alm.jl#L42-L51" target="_blank">source</a></section></article><h2 id="Converting-between-pixel-space-and-harmonic-space"><a class="docs-heading-anchor" href="#Converting-between-pixel-space-and-harmonic-space">Converting between pixel space and harmonic space</a><a id="Converting-between-pixel-space-and-harmonic-space-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-between-pixel-space-and-harmonic-space" title="Permalink"></a></h2><p>Healpix.jl implements the four functions <a href="#Healpix.alm2map"><code>alm2map</code></a>, <a href="#Healpix.map2alm"><code>map2alm</code></a>, <a href="#Healpix.alm2map!"><code>alm2map!</code></a>, and <a href="#Healpix.map2alm!"><code>map2alm!</code></a> to convert a map from a pixel-space representation to the harmonic space and vice-versa. The functions ending with <code>!</code> are <em>mutating</em> functions, which means that they assume that the result must be saved in a preallocated variable; they are space- and time-efficient and should be used when you want your code to be performant, or when you plan to apply the same operation several times (e.g., in a Monte Carlo simulation).</p><p>Here is an example:</p><pre><code class="language-julia hljs">using Random

# Ensure reproducibility by using a fixed seed
Random.seed!(1234)

nside = 8
m = HealpixMap{Float32,RingOrder}(nside)

# Initialize the pixels to random values in the 0…1 range
for i in 1:length(m)
    m[i] = rand(Float32)
end

alm = map2alm(m)

# Go back to pixel space
newm = alm2map(alm, nside)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">768-element HealpixMap{Float64, RingOrder, Vector{Float64}}:
  0.16526318742679247
  0.36187810449645164
 -0.0013815388023584868
  0.40084766002795014
  0.2530007233310311
  0.77859569791935
  0.4307118719975978
  0.9379452241907029
  0.7554174116102924
  0.6032735376338989
  ⋮
  0.44347259128908334
  0.4226379392252661
 -0.2052063921524326
  0.41659016756519407
  0.6860000214208772
  0.7211351759306383
  0.6707478409770001
  0.4779130715875933
  0.710910105374082</code></pre><p>The variable <code>newm</code> is a map that is close enough to <code>m</code>, yet it is not exactly the same because of the approximations done by both <code>map2alm</code> and <code>alm2map</code>.</p><article class="docstring"><header><a class="docstring-binding" href="#Healpix.map2alm!" id="Healpix.map2alm!"><code>Healpix.map2alm!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">map2alm!(map::HealpixMap{Float64, RingOrder, Array{Float64, 1}}, alm::Alm{ComplexF64, Array{ComplexF64, 1}}; niter::Integer=3)
map2alm!(map::PolarizedHealpixMap{Float64, RingOrder, Array{Float64, 1}}, alm::Array{Alm{ComplexF64, Array{ComplexF64, 1}},1};
    niter::Integer=3)</code></pre><p>This function performs a spherical harmonic transform on the map and places the results in the passed <code>alm</code> object. This function requires types derived from Float64, since it is done in-place.</p><p><strong>Arguments</strong></p><ul><li><p><code>map</code>: the map that must be decomposed in spherical harmonics. It can either be a <code>HealpixMap{Float64, RingOrder}</code> type (scalar map) or a <code>PolarizedHealpixMap{Float64, RingOrder}</code> type (polarized map).</p></li><li><p><code>alm::Alm{ComplexF64, Array{ComplexF64, 1}}</code>: the spherical harmonic coefficients to be written to.</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>niter::Integer</code>: number of iterations of SHTs to perform, to enhance accuracy</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/sphtfunc.jl#L74-L96" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#Healpix.map2alm" id="Healpix.map2alm"><code>Healpix.map2alm</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">map2alm(map::HealpixMap{Float64, RingOrder, AA};
    lmax=nothing, mmax=nothing, niter::Integer=3)
map2alm(m::HealpixMap{T, RingOrder, AA}; lmax=nothing, mmax=nothing,
    niter::Integer=3) where {T &lt;: Real, AA &lt;: AbstractArray{T, 1} }</code></pre><p>Compute the spherical harmonic coefficients of a map. To enhance precision, more iterations of the transforms can be performed by passing a nonzero <code>niter</code>. The underlying SHT library libsharp performs all calculations using <code>Cdouble</code> types, so all inputs are converted to types based on Float64.</p><p><strong>Arguments</strong></p><ul><li><code>map</code>: the map to decompose in spherical harmonics. It can either be a <code>HealpixMap{T, RingOrder, AA}</code> type (scalar map) or a <code>PolarizedHealpixMap{T, RingOrder, AA}</code> type (polarized map).</li></ul><p><strong>Keywords</strong></p><ul><li><p><code>lmax::Integer</code>: the maximum ℓ coefficient, will default to 3*nside-1 if not specified.</p></li><li><p><code>mmax::Integer</code>: the maximum m coefficient</p></li><li><p><code>niter::Integer</code>: number of SHT iterations, to enhance precision. Defaults to 3</p></li></ul><p><strong>Returns</strong></p><ul><li><code>Alm{ComplexF64, Array{ComplexF64, 1}}</code>: the spherical harmonic coefficients corresponding to the map</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/sphtfunc.jl#L158-L190" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#Healpix.alm2map!" id="Healpix.alm2map!"><code>Healpix.alm2map!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alm2map!(alm::Alm{ComplexF64, Array{ComplexF64, 1}}, map::HealpixMap{Float64, RingOrder, Array{Float64, 1}})
alm2map!(alm::Array{Alm{ComplexF64, Array{ComplexF64, 1}},1}, map::PolarizedHealpixMap{Float64, RingOrder, Array{Float64, 1}})</code></pre><p>This function performs a spherical harmonic transform on the map and places the results in the passed <code>alm</code> object. This function requires types derived from Float64, since it is done in-place.</p><p><strong>Arguments</strong></p><ul><li><p><code>alm::Alm{ComplexF64, Array{ComplexF64, 1}}</code>: the spherical harmonic coefficients to perform the spherical harmonic transform on.</p></li><li><p><code>map</code>: the map that will contain the result. It can either be a <code>HealpixMap{Float64, RingOrder, Array{Float64, 1}}</code> type (scalar map) or a <code>PolarizedHealpixMap{Float64, RingOrder, Array{Float64, 1}}</code> (polarized map).</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/sphtfunc.jl#L257-L275" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#Healpix.alm2map" id="Healpix.alm2map"><code>Healpix.alm2map</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alm2map(alm::Alm{ComplexF64, Array{Float64, 1}}, nside::Integer)
alm2map(alm::Alm{T, Array{T, 1}}, nside::Integer) where T
alm2map(alm::Array{Alm{ComplexF64, Array{ComplexF64, 1}},1}, nside::Integer)
alm2map(alms::Array{Alm{T, Array{T, 1}},1}, nside::Integer) where T</code></pre><p>Compute a map from spherical harmonic coefficients. The underlying SHT library libsharp performs all calculations in Cdouble, so all inputs are converted to types based on Float64.</p><p><strong>Arguments</strong></p><ul><li><code>alm</code>: the spherical harmonic coefficients to transform. If of type <code>Alm{T, Array{T, 1}}</code>, we assume a spin-0 spherical harmonic transform. If an array of <code>Alm</code> is passed, we assume that the components correspond to T, E, and B coefficients.</li></ul><p><strong>Keywords</strong></p><ul><li><code>nside::Integer</code>: Healpix resolution parameter</li></ul><p><strong>Returns</strong></p><ul><li><code>HealpixMap{Float64, RingOrder, Array{Float64, 1}}</code> or <code>PolarizedHealpixMap{Float64, RingOrder, Array{Float64, 1}}</code> depending on if the input alm is of type <code>Alm{T, Array{T, 1}}</code> or <code>Array{Alm{T, Array{T, 1}}}</code> respectively.</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/sphtfunc.jl#L326-L352" target="_blank">source</a></section></article><h2 id="From-harmonic-coefficients-to-the-power-spectrum"><a class="docs-heading-anchor" href="#From-harmonic-coefficients-to-the-power-spectrum">From harmonic coefficients to the power spectrum</a><a id="From-harmonic-coefficients-to-the-power-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#From-harmonic-coefficients-to-the-power-spectrum" title="Permalink"></a></h2><p>You can use the function <a href="#Healpix.alm2cl"><code>alm2cl</code></a> to convert a set of <span>$a_{\ell m}$</span> coefficients into the components <span>$C_\ell$</span> of the power spectrum.  The pixelization also induces a transfer function, which can be obtained from <a href="#Healpix.pixwin"><code>pixwin</code></a>. A simple Gaussian beam window function in the asymptotic small-beam limit can be computed with <a href="#Healpix.gaussbeam"><code>gaussbeam</code></a>.</p><article class="docstring"><header><a class="docstring-binding" href="#Healpix.alm2cl" id="Healpix.alm2cl"><code>Healpix.alm2cl</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alm2cl(alm::Alm{Complex{T}}) where {T &lt;: Number}
alm2cl(alm₁::Alm{Complex{T}}, alm₂::Alm{Complex{T}}) where {T &lt;: Number}</code></pre><p>Compute <span>$C_{\ell}$</span> from the spherical harmonic coefficients of one or two fields.</p><p><strong>Arguments</strong></p><ul><li><code>alm₁::Alm{Complex{T}}</code>: the spherical harmonic coefficients of the first field</li><li><code>alm₂::Alm{Complex{T}}</code>: the spherical harmonic coefficients of the second field</li></ul><p><strong>Returns</strong></p><ul><li><code>Array{T}</code> containing C_{�ll}, with the first element referring to ℓ=0.</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/alm.jl#L111-L124" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#Healpix.pixwin" id="Healpix.pixwin"><code>Healpix.pixwin</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pixwin(nside; pol=false)</code></pre><p><strong>Arguments:</strong></p><ul><li><code>nside</code>: HEALPix resolution parameter</li></ul><p><strong>Keywords</strong></p><ul><li><code>pol::Bool=false</code>: if true, also return polarization pixel window</li></ul><p><strong>Returns:</strong></p><ul><li><code>Vector{Float64}</code> pixel window function. If <code>pol=true</code>, returns a Tuple   of the temperature and polarization pixel windows.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; pixwin(4)
17-element Vector{Float64}:
 1.0000000000020606
 0.9942340766588788
 ⋮
 0.4222841034207188</code></pre></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/sphtfunc.jl#L400-L422" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#Healpix.gaussbeam" id="Healpix.gaussbeam"><code>Healpix.gaussbeam</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gaussbeam(fwhm::T, lmax::Int; pol=false) where T</code></pre><p>Compute the Gaussian beam window function <span>$B_{\ell}$</span> given the FWHM of the beam in radians, where  <span>$C_{\ell, \mathrm{measured}} = B_{\ell}^2 C_{\ell}$</span>. This beam is valid in the limit of  <span>$\sigma^2 \ll 0$</span>, which is the case for all high-resolution CMB experiments.</p><p><strong>Arguments</strong></p><ul><li><code>fwhm::T</code>: FWHM of the Gaussian beam in radians</li><li><code>lmax::Int</code>: maximum multipole ℓ</li><li><code>pol=false</code>: if false, returns the spin-0 beam for i.e. intensity. if true, returns the spin-2 beam</li></ul><p><strong>Returns</strong></p><ul><li><code>Array{T,1}</code> containing <span>$B_{\ell}$</span>, with the first element referring to ℓ=0.</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/alm.jl#L149-L163" target="_blank">source</a></section></article><h2 id="Loading-and-saving-harmonic-coefficients"><a class="docs-heading-anchor" href="#Loading-and-saving-harmonic-coefficients">Loading and saving harmonic coefficients</a><a id="Loading-and-saving-harmonic-coefficients-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-and-saving-harmonic-coefficients" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" href="#Healpix.readAlmFromFITS" id="Healpix.readAlmFromFITS"><code>Healpix.readAlmFromFITS</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">readAlmFromFITS{T &lt;: Complex}(f::CFITSIO.FITSFile, t::Type{T}) -&gt; Alm{T}
readAlmFromFITS{T &lt;: Complex}(fileName::String, t::Type{T}) -&gt; Alm{T}</code></pre><p>Read a set of a_ℓm coefficients from a FITS file. If the code fails, CFITSIO will raise an exception. (Refer to the CFITSIO library for more information.)</p></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/alm.jl#L71-L78" target="_blank">source</a></section></article><h2 id="Full-Pixel-Weights"><a class="docs-heading-anchor" href="#Full-Pixel-Weights">Full Pixel Weights</a><a id="Full-Pixel-Weights-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Pixel-Weights" title="Permalink"></a></h2><p>The default <a href="#Healpix.map2alm"><code>map2alm</code></a> uses iteration to obtain an accurate transform. One can instead apply a pixel weight to compute an accurate transform in a single pass, like quadrature. The easiest way to the pixel weight files is to run</p><pre><code class="nohighlight hljs">git clone --depth 1 https://github.com/healpy/healpy-data</code></pre><p>These weights are in a compressed format that is read with <a href="#Healpix.readFullWeights"><code>readFullWeights</code></a> and multiplied into a map with <a href="#Healpix.applyFullWeights!"><code>applyFullWeights!</code></a>. </p><pre><code class="language-julia hljs">nside = 32
compressed_weights = Healpix.readFullWeights(
    "healpix_full_weights_nside_$(lpad(nside,4,'0')).fits")
m = Healpix.HealpixMap{Float64,Healpix.RingOrder}(ones(Healpix.nside2npix(nside)))
Healpix.applyFullWeights!(m, compressed_weights)
alm = Healpix.map2alm(m; niter=0)</code></pre><p>The subsequent <a href="#Healpix.map2alm"><code>map2alm</code></a> only needs <code>niter=0</code>.</p><article class="docstring"><header><a class="docstring-binding" href="#Healpix.readFullWeights" id="Healpix.readFullWeights"><code>Healpix.readFullWeights</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">readFullWeights(filename::String)</code></pre><p>Read the set of pixel weights used to compute the generalized Fourier transform of a map.</p><p>These weights are usually precomputed; you can download the ones available in the <a href="https://github.com/healpy/healpy-data">Healpy repository</a> using the following command:</p><pre><code class="nohighlight hljs">git clone --depth 1 https://github.com/healpy/healpy-data</code></pre><p><strong>Arguments:</strong></p><ul><li><code>filename::String</code>: filename of the full pixel weights</li></ul><p><strong>Returns:</strong></p><ul><li><code>Vector{Float64}</code>: contains the compressed pixel weights</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/weights.jl#L23-L43" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-binding" href="#Healpix.applyFullWeights!" id="Healpix.applyFullWeights!"><code>Healpix.applyFullWeights!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">applyFullWeights!(m::HealpixMap{T, RingOrder}, [wgt::Vector{T}]) where T</code></pre><p>Apply a pixel weighting to a map for more accurate SHTs. Note that  this only helps for <code>lmax&lt;=1.5*Nside</code>. If this is not the case, the  pixel weights may do more harm than good.</p><p>Pixel weights are automatically downloaded if not specified. </p><p><strong>Arguments:</strong></p><ul><li><code>m::HealpixMap{T, RingOrder}</code>: map to modify</li><li><code>wgt::Vector{T}</code> (optional): compressed pixel weights. If not specified, this routine will   look for weights in artifacts.</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/weights.jl#L51-L64" target="_blank">source</a></section><section><div><pre><code class="nohighlight hljs">applyFullWeights!(m::PolarizedHealpixMap{T, RingOrder}, [wgt::Vector{T}]) where T</code></pre><p>Apply a pixel weighting to a polarized map for more accurate SHTs.</p><p><strong>Arguments:</strong></p><ul><li><code>m::PolarizedHealpixMap{T, RingOrder}</code>: map to modify</li><li><code>wgt::Vector{T}</code> (optional): compressed pixel weights. If not specified, an artifact        will be sought.</li></ul></div><a class="docs-sourcelink" href="https://github.com/ziotom78/Healpix.jl/blob/b9e8d91ddd5f3dfdb89ecbe913969904a9ff8f7b/src/weights.jl#L109-L118" target="_blank">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mapfunc/">« Map functions</a><a class="docs-footer-nextpage" href="../visualization/">Visualization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 17 October 2022 16:25">Monday 17 October 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>